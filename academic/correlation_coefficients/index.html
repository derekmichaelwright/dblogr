<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

        <meta name="author" content="Derek Michael Wright www.dblogr.com/ or derekmichaelwright.github.io/dblogr derek.wright@usask.ca" />
    
    
    <title>Correlation Coefficients and Predictive Models</title>

        <script src="index_files/header-attrs-2.29/header-attrs.js"></script>
        <script src="index_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="index_files/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="index_files/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="index_files/navigation-1.1/tabsets.js"></script>
        <script src="index_files/navigation-1.1/codefolding.js"></script>
        <link href="index_files/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="index_files/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="index_files/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="index_files/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="index_files/readthedown-0.1/readthedown.js"></script>
        <link href="index_files/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
        <link href="index_files/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />
        <link href="index_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
        <script src="index_files/htmlwidgets-1.6.4/htmlwidgets.js"></script>
        <link href="index_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
        <script src="index_files/datatables-binding-0.33/datatables.js"></script>
        <link href="index_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
        <link href="index_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
        <script src="index_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
        <link href="index_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
        <script src="index_files/crosstalk-1.2.1/js/crosstalk.min.js"></script>
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
        <link rel="stylesheet" href="C:/gitfolder/dblogr/custom_dblogr.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
        <script>
      $(document).ready(function () {
	  	  	  window.initializeCodeFolding("show" === "show");
	        });
    </script>
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
      <div class="btn-group pull-right">
     <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
     <ul class="dropdown-menu" style="min-width: 50px;">
	    	    <li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
	    <li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
	    	    	         </ul>
   </div>
   
      <div class="topnav">
        <a href="https://derekmichaelwright.github.io/dblogr"><i class="fa fa-house"></i>  dblogr.com/</a>
        <a href="https://derekmichaelwright.github.io/dblogr#photography"><i class="fa fa-image"></i></a>
        <a href="https://derekmichaelwright.github.io/dblogr#publications"><i class="fa fa-book"></i></a>
        <a href="https://derekmichaelwright.github.io/dblogr#academic-work"><i class="fa fa-newspaper"></i></a>
        <a href="https://derekmichaelwright.github.io/dblogr#packages"><i class="fab fa-r-project"></i></a>
        <a href="https://derekmichaelwright.github.io/dblogr#blog"><i class="fa fa-chart-line"></i></a>
      </div>
        
      <h1 class="title">Correlation Coefficients and Predictive
Models</h1>
         <h1 class="subtitle">A vignette on how to properly use
correlation coefficients when evaluating predictive models</h1>
   
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">Correlation Coefficients and Predictive
Models</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#introduction"
      id="toc-introduction">Introduction</a></li>
      <li><a href="#prepare-data" id="toc-prepare-data">Prepare Data</a>
      <ul>
      <li><a href="#dataset-1" id="toc-dataset-1">Dataset 1</a></li>
      <li><a href="#dataset-2" id="toc-dataset-2">Dataset 2</a></li>
      </ul></li>
      <li><a href="#correlation-between-two-traits"
      id="toc-correlation-between-two-traits">Correlation Between Two
      Traits</a></li>
      <li><a href="#calculating-r2" id="toc-calculating-r2">Calculating
      <em>R<sup>2</sup></em></a>
      <ul>
      <li><a href="#pearsons-r2" id="toc-pearsons-r2"><em>Pearson’s
      R<sup>2</sup></em></a></li>
      <li><a href="#sum-of-squares-r2"
      id="toc-sum-of-squares-r2"><em>Sum of Squares
      R<sup>2</sup></em></a></li>
      </ul></li>
      <li><a href="#negative-r2-values"
      id="toc-negative-r2-values">Negative <em>R<sup>2</sup></em>
      values</a></li>
      <li><a href="#effect-of-range" id="toc-effect-of-range">Effect of
      Range</a></li>
      <li><a href="#rmse" id="toc-rmse">RMSE</a></li>
      <li><a href="#final-plots" id="toc-final-plots">Final
      Plots</a></li>
      <li><a href="#model-evaluation" id="toc-model-evaluation">Model
      Evaluation</a></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                  <p class="author"><span class="glyphicon glyphicon-user"></span> Derek
Michael Wright <a href="http://dblogr.com/">www.dblogr.com/</a> or <a
href="https://derekmichaelwright.github.io/dblogr/">derekmichaelwright.github.io/dblogr</a>
<a href="mailto:derek.wright@usask.ca"
class="email">derek.wright@usask.ca</a></p>
                        <p class="date"><span class="glyphicon glyphicon-calendar"></span> Last
updated: 2024-11-23</p>
          </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<hr />
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The correlation coefficient
(<strong><em>R<sup>2</sup></em></strong>), which indicates the
proportion of variation explained by an independent variable or model,
can be misused/incorectly used when evaluating predictive models.
Depending on the situation, different calculations for
<em>R<sup>2</sup></em> can be used to convey different meanings. The
goal of this vignette is to help clear up this confusion, with a few
different examples.</p>
<hr />
</div>
<div id="prepare-data" class="section level1 tabset tabset-pills">
<h1 class="tabset tabset-pills">Prepare Data</h1>
<blockquote>
<ul>
<li><i class="far fa-floppy-disk" role="presentation" aria-label="floppy-disk icon"></i>
<a
href="data_correlation_coefficients.xlsx">data_correlation_coefficients.xlsx</a></li>
</ul>
</blockquote>
<div class="sourceCode" id="cb1"><pre
class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># devtools::install_github(&quot;derekmichaelwright/agData&quot;)</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(agData)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(readxl)  <span class="co"># read_xlsx()</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(ggpmisc) <span class="co"># stat_poly_eq()</span></span></code></pre></div>
<div id="dataset-1" class="section level2">
<h2>Dataset 1</h2>
<p><br></p>
<ul>
<li><code>Entry</code>: 1 Lentil Genotype</li>
<li><code>Expt</code>: 18 Site-years</li>
<li><code>MacroEnv</code>: 3 Macroenvironments</li>
<li><code>Rep</code>: 1-3 Reps per site-year</li>
<li><code>T_mean</code>: Mean temperature</li>
<li><code>P_mean</code>: Mean photoperiod</li>
<li><code>DTF</code>: Days from sowing to flower</li>
<li><code>DTM</code>: Days from sowing to swollen pod</li>
<li><code>DTM</code>: Days from sowing to maturity</li>
<li><code>RDTF</code>: Rate of progress towards flowering =
<code>1 / DTF</code></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">&quot;data_correlation_coefficients.xlsx&quot;</span>, <span class="st">&quot;data_1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RDTF =</span> <span class="dv">1</span> <span class="sc">/</span> DTF) <span class="co"># Rate of progress towards flowering</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># Preview data</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(d1)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-1f383aba6a7ceb4dd50d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1f383aba6a7ceb4dd50d">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54"],[33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33],["Ro16","Ro16","Ro16","Ro17","Ro17","Ro17","Su16","Su16","Su16","Su17","Su17","Su17","Su18","Su18","Su18","Us18","Us18","Us18","In16","In16","In16","In17","In17","In17","Ba16","Ba16","Ba16","Ba17","Ba17","Ba17","Ne16","Ne16","Ne16","Ne17","Ne17","Ne17","Sp16","Sp16","Sp16","Sp17","Sp17","Sp17","Mo16","Mo16","Mo16","Mo17","Mo17","Mo17","It16","It16","It16","It17","It17","It17"],["Macroenvironment 1","Macroenvironment 1","Macroenvironment 1","Macroenvironment 1","Macroenvironment 1","Macroenvironment 1","Macroenvironment 1","Macroenvironment 1","Macroenvironment 1","Macroenvironment 1","Macroenvironment 1","Macroenvironment 1","Macroenvironment 1","Macroenvironment 1","Macroenvironment 1","Macroenvironment 1","Macroenvironment 1","Macroenvironment 1","Macroenvironment 2","Macroenvironment 2","Macroenvironment 2","Macroenvironment 2","Macroenvironment 2","Macroenvironment 2","Macroenvironment 2","Macroenvironment 2","Macroenvironment 2","Macroenvironment 2","Macroenvironment 2","Macroenvironment 2","Macroenvironment 2","Macroenvironment 2","Macroenvironment 2","Macroenvironment 2","Macroenvironment 2","Macroenvironment 2","Macroenvironment 3","Macroenvironment 3","Macroenvironment 3","Macroenvironment 3","Macroenvironment 3","Macroenvironment 3","Macroenvironment 3","Macroenvironment 3","Macroenvironment 3","Macroenvironment 3","Macroenvironment 3","Macroenvironment 3","Macroenvironment 3","Macroenvironment 3","Macroenvironment 3","Macroenvironment 3","Macroenvironment 3","Macroenvironment 3"],[1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,3,1,2,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3],[17.2,17.2,17.2,17.5,17.5,17.5,16.7,16.7,16.7,15.7,15.7,15.7,17.6,17.6,17.6,15.8,15.8,15.8,17.6,17.6,17.6,20.6,20.6,20.6,18.6,18.6,18.6,21.7,21.7,21.7,19.2,19.2,19.2,19.4,19.4,19.4,12.5,12.5,12.5,11.7,11.7,11.7,12,12,12,11.8,11.8,11.8,10.6,10.6,10.6,11.2,11.2,11.2],[16.2,16.2,16.2,16.4,16.4,16.4,15.9,15.9,15.9,16.1,16.1,16.1,16.1,16.1,16.1,14.3,14.3,14.3,10.9,10.9,10.9,10.7,10.7,10.7,10.8,10.8,10.8,11,11,11,11,11,11,10.8,10.8,10.8,10.9,10.9,10.9,11.1,11.1,11.1,10.8,10.8,10.8,11.5,11.5,11.5,10.8,10.8,10.8,10.8,10.8,10.8],[45,44,44,38,39,39,44,45,45,44,45,46,42,43,42,51,null,52,43,43,55,55,52,52,59,60,60,57,56,56,81,77,82,82,65,83,97,97,97,97,104,97,80,80,null,86,86,86,114,114,120,121,128,127],[62,64,61,60,57,57,65,62,63,64,65,67,64,62,64,69,null,70,95,null,null,97,null,91,81,82,82,73,71,70,null,111,106,114,115,114,118,114,109,113,113,104,121,121,121,104,108,106,130,133,145,146,146,145],[96,96,92,82,80,77,95,94,95,83,79,81,91,87,93,92,96,92,105,null,null,101,null,98,100,101,102,101,93,90,null,124,121,135,134,136,134,134,134,128,126,126,142,142,142,null,140,140,164,175,168,164,167,161],[0.02222222222222222,0.02272727272727273,0.02272727272727273,0.02631578947368421,0.02564102564102564,0.02564102564102564,0.02272727272727273,0.02222222222222222,0.02222222222222222,0.02272727272727273,0.02222222222222222,0.02173913043478261,0.02380952380952381,0.02325581395348837,0.02380952380952381,0.0196078431372549,null,0.01923076923076923,0.02325581395348837,0.02325581395348837,0.01818181818181818,0.01818181818181818,0.01923076923076923,0.01923076923076923,0.01694915254237288,0.01666666666666667,0.01666666666666667,0.01754385964912281,0.01785714285714286,0.01785714285714286,0.01234567901234568,0.01298701298701299,0.01219512195121951,0.01219512195121951,0.01538461538461539,0.01204819277108434,0.01030927835051546,0.01030927835051546,0.01030927835051546,0.01030927835051546,0.009615384615384616,0.01030927835051546,0.0125,0.0125,null,0.01162790697674419,0.01162790697674419,0.01162790697674419,0.008771929824561403,0.008771929824561403,0.008333333333333333,0.008264462809917356,0.0078125,0.007874015748031496]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Entry<\/th>\n      <th>Expt<\/th>\n      <th>MacroEnv<\/th>\n      <th>Rep<\/th>\n      <th>T_mean<\/th>\n      <th>P_mean<\/th>\n      <th>DTF<\/th>\n      <th>DTS<\/th>\n      <th>DTM<\/th>\n      <th>RDTF<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,4,5,6,7,8,9,10]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Entry","targets":1},{"name":"Expt","targets":2},{"name":"MacroEnv","targets":3},{"name":"Rep","targets":4},{"name":"T_mean","targets":5},{"name":"P_mean","targets":6},{"name":"DTF","targets":7},{"name":"DTS","targets":8},{"name":"DTM","targets":9},{"name":"RDTF","targets":10}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="dataset-2" class="section level2">
<h2>Dataset 2</h2>
<p><br></p>
<ul>
<li><code>Entry</code>: 324 Genotypes</li>
<li><code>Expt</code>: 3 Site-years</li>
<li><code>MacroEnv</code>: 3 Macroenvironments</li>
<li><code>DTF</code>: Days from sowing to flower</li>
<li><code>Predicted_DTF</code>: Predicted values of DTF</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">&quot;data_correlation_coefficients.xlsx&quot;</span>, <span class="st">&quot;data_2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="fu">factor</span>(Expt, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Saskatchewan&quot;</span>, <span class="st">&quot;Nepal&quot;</span>, <span class="st">&quot;Italy&quot;</span>)))</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># Preview data</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(d2)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-32f4780dacc501108319" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-32f4780dacc501108319">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842","843","844","845","846","847","848","849","850","851","852","853","854","855","856","857","858","859","860","861","862","863","864","865","866","867","868","869","870","871","872","873","874","875","876","877","878","879","880","881","882","883","884","885","886","887","888","889","890","891","892","893","894","895","896","897","898","899","900","901","902","903","904","905","906","907","908","909","910","911","912","913","914","915","916","917","918","919","920","921","922","923","924","925","926","927","928","929","930","931","932","933","934","935","936","937","938","939","940","941","942","943","944","945","946","947","948","949","950","951","952","953","954","955","956","957","958","959","960","961","962","963","964","965","966","967","968","969","970","971","972"],[1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7,8,8,8,9,9,9,10,10,10,11,11,11,12,12,12,13,13,13,14,14,14,15,15,15,16,16,16,17,17,17,18,18,18,19,19,19,20,20,20,21,21,21,22,22,22,23,23,23,24,24,24,25,25,25,26,26,26,27,27,27,28,28,28,29,29,29,30,30,30,31,31,31,32,32,32,33,33,33,34,34,34,35,35,35,36,36,36,37,37,37,38,38,38,39,39,39,40,40,40,41,41,41,42,42,42,43,43,43,44,44,44,45,45,45,46,46,46,47,47,47,48,48,48,49,49,49,50,50,50,51,51,51,52,52,52,53,53,53,54,54,54,55,55,55,56,56,56,57,57,57,58,58,58,59,59,59,60,60,60,61,61,61,62,62,62,63,63,63,64,64,64,65,65,65,66,66,66,67,67,67,68,68,68,69,69,69,70,70,70,71,71,71,72,72,72,73,73,73,74,74,74,75,75,75,76,76,76,77,77,77,78,78,78,79,79,79,80,80,80,81,81,81,82,82,82,83,83,83,84,84,84,85,85,85,86,86,86,87,87,87,88,88,88,89,89,89,90,90,90,91,91,91,92,92,92,93,93,93,94,94,94,95,95,95,96,96,96,97,97,97,98,98,98,99,99,99,100,100,100,101,101,101,102,102,102,103,103,103,104,104,104,105,105,105,106,106,106,107,107,107,108,108,108,109,109,109,110,110,110,111,111,111,112,112,112,113,113,113,114,114,114,115,115,115,116,116,116,117,117,117,118,118,118,119,119,119,120,120,120,121,121,121,122,122,122,123,123,123,124,124,124,125,125,125,126,126,126,127,127,127,128,128,128,129,129,129,130,130,130,131,131,131,132,132,132,133,133,133,134,134,134,135,135,135,136,136,136,137,137,137,138,138,138,139,139,139,140,140,140,141,141,141,142,142,142,143,143,143,144,144,144,145,145,145,146,146,146,147,147,147,148,148,148,149,149,149,150,150,150,151,151,151,152,152,152,153,153,153,154,154,154,155,155,155,156,156,156,157,157,157,158,158,158,159,159,159,160,160,160,161,161,161,162,162,162,163,163,163,164,164,164,165,165,165,166,166,166,167,167,167,168,168,168,169,169,169,170,170,170,171,171,171,172,172,172,173,173,173,174,174,174,175,175,175,176,176,176,177,177,177,178,178,178,179,179,179,180,180,180,181,181,181,182,182,182,183,183,183,184,184,184,185,185,185,186,186,186,187,187,187,188,188,188,189,189,189,190,190,190,191,191,191,192,192,192,193,193,193,194,194,194,195,195,195,196,196,196,197,197,197,198,198,198,199,199,199,200,200,200,201,201,201,202,202,202,203,203,203,204,204,204,205,205,205,206,206,206,207,207,207,208,208,208,209,209,209,210,210,210,211,211,211,212,212,212,213,213,213,214,214,214,215,215,215,216,216,216,217,217,217,218,218,218,219,219,219,220,220,220,221,221,221,222,222,222,223,223,223,224,224,224,225,225,225,226,226,226,227,227,227,228,228,228,229,229,229,230,230,230,231,231,231,232,232,232,233,233,233,234,234,234,235,235,235,236,236,236,237,237,237,238,238,238,239,239,239,240,240,240,241,241,241,242,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255,255,255,256,256,256,257,257,257,258,258,258,259,259,259,260,260,260,261,261,261,262,262,262,263,263,263,264,264,264,265,265,265,266,266,266,267,267,267,268,268,268,269,269,269,270,270,270,271,271,271,272,272,272,273,273,273,274,274,274,275,275,275,276,276,276,277,277,277,278,278,278,279,279,279,280,280,280,281,281,281,282,282,282,283,283,283,284,284,284,285,285,285,286,286,286,287,287,287,288,288,288,289,289,289,290,290,290,291,291,291,292,292,292,293,293,293,294,294,294,295,295,295,296,296,296,297,297,297,298,298,298,299,299,299,300,300,300,301,301,301,302,302,302,303,303,303,304,304,304,305,305,305,306,306,306,307,307,307,308,308,308,309,309,309,310,310,310,311,311,311,312,312,312,313,313,313,314,314,314,315,315,315,316,316,316,317,317,317,318,318,318,319,319,319,320,320,320,321,321,321,322,322,322,323,323,323,324,324,324],["Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy","Saskatchewan","Nepal","Italy"],["Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3","Macroenvironment 1","Macroenvironment 2","Macroenvironment 3"],[53.6666666666667,123,136.666666666667,57.3333333333333,124.5,128,59,122.333333333333,134,56,118,129.333333333333,51,122.5,126.333333333333,56,127,131,54,125,139.666666666667,53,123.333333333333,129.333333333333,54.3333333333333,118,134.666666666667,55.6666666666667,120.666666666667,130.666666666667,53.6666666666667,117,129.666666666667,50.6666666666667,120,129.666666666667,56,117,147.333333333333,56,131,127.666666666667,56,124.5,128,53.6666666666667,125.333333333333,129.666666666667,53,120,129.333333333333,54,106.333333333333,125.333333333333,57.6666666666667,118.666666666667,129.333333333333,55,128.333333333333,133.666666666667,54,110.666666666667,125.333333333333,51,103.333333333333,123,47,115.666666666667,129.333333333333,54.3333333333333,118.666666666667,128,51.6666666666667,106.666666666667,124.666666666667,47.6666666666667,99.6666666666667,120.666666666667,45.3333333333333,106.333333333333,131,43.6666666666667,115.5,131,51,107.666666666667,134,45.6666666666667,102.333333333333,125.333333333333,44.3333333333333,82.3333333333333,116.333333333333,43.6666666666667,101.666666666667,113.666666666667,44.6666666666667,80,116,53,129.666666666667,145,51,137,135,54.6666666666667,126,133.333333333333,51,126,144.666666666667,47,99.6666666666667,116.333333333333,55.3333333333333,121,136.666666666667,53.6666666666667,112.333333333333,131,56,123.666666666667,140,51.6666666666667,102.666666666667,123,45,94,116.333333333333,49.6666666666667,111.333333333333,129.666666666667,46.3333333333333,107,121,48,124.666666666667,144.666666666667,45,120.333333333333,147.333333333333,47.3333333333333,122.333333333333,143,45,98.3333333333333,120.666666666667,55,144,147.666666666667,48.3333333333333,121.333333333333,141.333333333333,43.3333333333333,100,114,48.3333333333333,88,108,44.3333333333333,98,116,46.3333333333333,87.5,114,45.3333333333333,99.3333333333333,114,44.3333333333333,92.3333333333333,116.333333333333,45.3333333333333,89.6666666666667,113.666666666667,44,86.6666666666667,112,48,123.666666666667,144.666666666667,45.6666666666667,103.5,134.333333333333,49,132,141.333333333333,47.6666666666667,99.6666666666667,120.666666666667,46.3333333333333,125.5,133.666666666667,49.3333333333333,125,129.333333333333,50,119.666666666667,131,46.6666666666667,95.3333333333333,113.666666666667,45.3333333333333,106.666666666667,120.666666666667,49.6666666666667,124,127.666666666667,46,96.6666666666667,119.333333333333,48.3333333333333,124.5,134,45,95.3333333333333,121,47,116.333333333333,128,46.3333333333333,102,120.666666666667,47.3333333333333,121.666666666667,123.666666666667,48.6666666666667,118.333333333333,134.666666666667,47.3333333333333,85,111.666666666667,49,126.333333333333,133.666666666667,49.3333333333333,119.666666666667,134.333333333333,52,123.5,133.333333333333,44.3333333333333,102.333333333333,116.333333333333,45,102,116.333333333333,54,123.333333333333,137.333333333333,47.6666666666667,118,127.666666666667,55.6666666666667,125,152,52.3333333333333,112.5,141.333333333333,55.3333333333333,134.666666666667,146.333333333333,49,120,125.666666666667,47.6666666666667,127.333333333333,120.666666666667,54.3333333333333,122.666666666667,138.333333333333,47.3333333333333,122.333333333333,129.666666666667,43.6666666666667,97,123.666666666667,48,126,125.333333333333,44.3333333333333,58.6666666666667,99,45,96.3333333333333,113.666666666667,47,85.3333333333333,109,47.3333333333333,107.333333333333,135,49,114,123.333333333333,49.3333333333333,91.3333333333333,113.666666666667,51.3333333333333,127.5,134,47.6666666666667,129.333333333333,123.333333333333,51,128.666666666667,127.666666666667,47.3333333333333,122,131.333333333333,49.3333333333333,91,113.666666666667,44,65,105,47,97.3333333333333,121,49.3333333333333,85,110.666666666667,49.3333333333333,128.666666666667,128,46.3333333333333,119,120.666666666667,45,99,113.666666666667,46,98.3333333333333,116.333333333333,43.3333333333333,83.3333333333333,110,45,90.6666666666667,121,45.3333333333333,89.6666666666667,118.333333333333,47,124.666666666667,132,50,113.666666666667,131.666666666667,47,107,127.666666666667,46.3333333333333,112.333333333333,120.666666666667,46.3333333333333,124,121,45.6666666666667,114.666666666667,120.666666666667,46.3333333333333,108.333333333333,120.666666666667,45,100.666666666667,115.333333333333,44.6666666666667,98.3333333333333,120.666666666667,45.6666666666667,93.3333333333333,116.333333333333,49.3333333333333,103.333333333333,121,61.3333333333333,126.333333333333,145,44,89.6666666666667,113.666666666667,56,104.5,132.666666666667,46.6666666666667,79,108,53,139,132.666666666667,51.6666666666667,120.333333333333,141,48.6666666666667,123,134.333333333333,51.6666666666667,126,148,53,121.333333333333,148,47,112.333333333333,133.333333333333,51,115.333333333333,136,49.6666666666667,136,137.333333333333,49.3333333333333,123,138.666666666667,50.6666666666667,108.666666666667,134.333333333333,50,128.666666666667,131.666666666667,48.3333333333333,117,132,50,130.666666666667,134,52.3333333333333,121.333333333333,133.666666666667,44,100,113.666666666667,44.6666666666667,91.3333333333333,113.666666666667,49.6666666666667,120,137,49.6666666666667,123,138,58.3333333333333,138,145,49.6666666666667,118.5,144.666666666667,50.3333333333333,123.666666666667,143,51,124.5,136.333333333333,45,112.333333333333,123,49,112.666666666667,133.666666666667,43.3333333333333,78,106.333333333333,49,122,132.666666666667,45.6666666666667,96.3333333333333,114,43,73.6666666666667,106.666666666667,49,130,146.333333333333,45.6666666666667,87,116.333333333333,53.3333333333333,125,134,56.6666666666667,146,146.333333333333,52,113.666666666667,133.666666666667,55,120,138.666666666667,51,123.666666666667,143.666666666667,52,110.333333333333,127,49.6666666666667,117.666666666667,134.333333333333,49,116,145,53.6666666666667,130,144,53.6666666666667,133,133.333333333333,44,96.3333333333333,114,48.3333333333333,113.333333333333,143.666666666667,47,107.333333333333,137.666666666667,50.3333333333333,113.666666666667,128,53,113.666666666667,132,47,106.5,137.666666666667,54.6666666666667,127,148.666666666667,57.6666666666667,130.333333333333,146,53,119.666666666667,132,50.6666666666667,122,127.666666666667,53,130.5,150,48.3333333333333,123.666666666667,145,48,106,127.666666666667,48,106.5,125.333333333333,47.3333333333333,105,121,46.6666666666667,109,125.333333333333,50,131.333333333333,145,49.6666666666667,119,129.666666666667,50,129.666666666667,134.666666666667,48.6666666666667,124,134.666666666667,49,111,133.333333333333,52,112.666666666667,132.666666666667,54,125,141.333333333333,54.3333333333333,129.666666666667,129.333333333333,49,119.333333333333,143.666666666667,52.6666666666667,113.666666666667,124,50,127,137,50,122.5,133.333333333333,45.6666666666667,111,121,52.3333333333333,129,133.333333333333,52.3333333333333,139.333333333333,135,55.6666666666667,125.333333333333,137.666666666667,45.3333333333333,118.666666666667,134.333333333333,52,99.3333333333333,118.333333333333,59,113.333333333333,132,55.6666666666667,137,145,49,133.5,148,51.6666666666667,132.666666666667,144.666666666667,48,117,127.666666666667,60.3333333333333,122.666666666667,137.333333333333,58.3333333333333,127.333333333333,144.666666666667,54,115,129.666666666667,47,111,131.333333333333,46.6666666666667,115.333333333333,133.333333333333,46,106,134.666666666667,50.3333333333333,135.666666666667,134.5,51,149,131.666666666667,46.3333333333333,125,146.333333333333,48.3333333333333,113,135.333333333333,47.3333333333333,113.5,144.666666666667,48.3333333333333,112,135,56.3333333333333,113.666666666667,137.666666666667,52.3333333333333,116.666666666667,137.333333333333,51,125.333333333333,138,52.6666666666667,122.333333333333,141.333333333333,54,132.5,134.333333333333,52.3333333333333,113.666666666667,138.666666666667,47,116.5,133.333333333333,46.6666666666667,116.5,125.666666666667,54,108.666666666667,125.666666666667,49.6666666666667,111.333333333333,136.666666666667,48.6666666666667,117.666666666667,136,48.6666666666667,132.666666666667,141.333333333333,50.6666666666667,132.666666666667,129.333333333333,48.3333333333333,131.333333333333,127.666666666667,50.3333333333333,123,125.333333333333,50,127,127.666666666667,49.6666666666667,125.666666666667,146.666666666667,49,113,143.666666666667,46,94.3333333333333,116.333333333333,46,97.6666666666667,118.666666666667,48,127.5,127.333333333333,47.6666666666667,110.333333333333,135,49.3333333333333,125.333333333333,145,48.6666666666667,134.666666666667,154,47.3333333333333,102.5,134,46.3333333333333,112,141.333333333333,46.6666666666667,110.666666666667,133.666666666667,49,112,143,48.6666666666667,118.333333333333,146.333333333333,51.3333333333333,105,153.666666666667,48,122.5,148.666666666667,49.6666666666667,119.333333333333,145,49,115,146,49,111.333333333333,144.666666666667,49,119,147.666666666667,48.6666666666667,110.333333333333,146.333333333333,48.6666666666667,121.5,138.666666666667,48.3333333333333,112.333333333333,131.666666666667,47.3333333333333,119.333333333333,145.666666666667,49.3333333333333,117,148.666666666667,47,123.666666666667,143.666666666667,46.6666666666667,116.666666666667,135.666666666667,50,122,147,50,135.666666666667,147,46.6666666666667,125,141,47.3333333333333,126.333333333333,145.666666666667,49.6666666666667,125,144,47,108,140.666666666667,48.3333333333333,125.333333333333,146,48.3333333333333,111.666666666667,138.666666666667,49.3333333333333,134.333333333333,148.333333333333,47.3333333333333,126.5,142.333333333333,49.6666666666667,122.666666666667,146.666666666667,48.3333333333333,110,144,44.6666666666667,118,134.666666666667,49,116.333333333333,144,46.3333333333333,122.333333333333,144.666666666667,50,120.666666666667,154,48.6666666666667,103.5,149.666666666667,46.6666666666667,126.666666666667,136.666666666667,47,112.666666666667,134.666666666667,52,110.666666666667,132.666666666667,50.6666666666667,120.666666666667,134.5,49.3333333333333,111.333333333333,145,51.3333333333333,123.5,147.333333333333,46.6666666666667,104,130,54.3333333333333,122.666666666667,148.666666666667,54.3333333333333,125,137,47.3333333333333,102,129.333333333333,49,109,129.666666666667,52.6666666666667,123.666666666667,137.666666666667,57.3333333333333,123.666666666667,134.333333333333,49,123.333333333333,134.333333333333,44.6666666666667,87.3333333333333,116,44.6666666666667,83.3333333333333,113.666666666667,48.6666666666667,119.666666666667,144.666666666667,45.3333333333333,96,121,46,94,121,48.6666666666667,100,120.666666666667,45,100.666666666667,113.666666666667,47.6666666666667,102,116.666666666667,46.6666666666667,97.3333333333333,114,47,94.6666666666667,114.666666666667,50.3333333333333,122,137,47,122.666666666667,141.333333333333,45.3333333333333,103.333333333333,120.666666666667,46.6666666666667,108,133.333333333333,46.6666666666667,108,131.333333333333,52,110.333333333333,134.333333333333,48.3333333333333,115.333333333333,143.666666666667,48,106.666666666667,128,57.3333333333333,118,134,58.3333333333333,120.333333333333,133.666666666667,51.3333333333333,133,141.333333333333,52.3333333333333,120.5,142,45.3333333333333,117.5,120.666666666667,48,101.666666666667,118.333333333333,46.6666666666667,99.3333333333333,121,52.3333333333333,113,129.333333333333,58,124.5,133.666666666667,51,103.666666666667,123,47.3333333333333,126.333333333333,125.666666666667,47.6666666666667,95.6666666666667,110.333333333333,50.6666666666667,130.666666666667,125.333333333333],[51.5870576651373,97.99714281066061,145.028774440554,55.2661293495463,93.53895849390889,136.587121382764,57.7796161602896,95.96950031857121,142.070395387266,53.7012110714531,87.579580666243,135.354713194727,51.2200786056896,89.6282554314579,135.501600175026,54.4738112527333,92.4863661541023,139.356135804228,52.2626107383587,92.5785005337295,145.927146152937,49.8655507593105,99.7042957161225,139.158850427482,52.3653218548326,93.08072245592,141.415169136177,54.0686726295303,79.05946051625919,137.135421199892,52.5709547943209,94.1447729684819,139.042407260526,50.7521261401416,91.0757678294525,135.411538195,54.4971209981165,94.4445384314447,148.613458486772,53.714076211052,92.82710671245989,141.073723443655,53.659450715931,98.4992441091092,135.905119966676,52.2285157318477,98.64340012926471,137.067475364132,50.5334206825864,92.3852404645114,142.918004306072,51.9655851901404,78.7958770099074,138.163867527817,55.7659451840697,96.1812052785107,139.351346117579,52.9364929933297,96.3825781745695,140.542677309523,52.6961506776834,88.77947964541291,138.261308404587,50.8338283078223,75.5378344619011,131.817862967632,46.2536599776275,85.0808613092177,142.020411090503,52.2396508874908,87.09438989878041,134.970122887616,50.7820555293712,81.7576361687656,135.854094699662,46.04418488647,80.0721954616069,119.238293051436,44.3665264979919,80.1739183251005,140.220621899878,43.3406567013972,84.1968823898162,137.637213543352,50.0204823912713,81.8557501148546,142.148051055705,43.8749767120648,76.4647249078517,131.987820079875,43.1582484075968,68.73810563368509,114.29954271592,43.0520622325715,75.4010275646507,110.344090278814,43.9714520940952,60.4749874343173,109.7060530388,51.3147080385272,99.6485703980249,144.307128169225,49.7677777427493,101.417940408488,137.87863883342,51.1595481543845,100.622326169082,132.245193019573,50.7342353501245,101.180997643495,141.168401420462,45.2953293724748,73.4516627613762,112.021085397342,51.9890530830851,94.15933176019431,141.050741148826,52.1230971942364,88.30077949094139,135.898694933091,54.8923895681364,90.3219296305586,150.09194615009,50.9589173914779,79.2160156972211,126.223152685266,43.9331732694437,70.7879052523013,111.651666827403,47.653150264032,92.2360024732894,143.012678877048,45.7819938614963,91.5342249376255,122.558753544879,46.4371705500875,88.89024844632161,148.015242534313,45.6883341205166,93.76532424133499,148.911563687025,46.3364621225931,89.1259791793689,139.132853609176,44.3293312140179,79.4755393165578,115.913011367408,52.7377809382328,97.785538860553,148.039697396485,46.9349190198921,90.2897374177293,143.926216691259,43.8284627661218,73.5053731386718,112.237423334272,47.4127422569467,64.832158218861,107.904569528193,44.3655933880111,68.18118466162269,110.065285540942,44.04348908973,66.5872992136236,114.885536741768,44.900793000016,74.8271362831269,111.915293414027,44.3561253028863,67.23838163098119,110.609783320953,44.506674015132,65.8795258378082,111.971701530497,43.9000620401236,67.1436896305741,112.289018113525,46.7463487233435,89.3169898280394,145.628069171587,45.5849734482438,83.7990799169409,139.840404905269,49.0579555377034,101.552567938319,144.16974729937,46.0030096121911,84.6729959242092,121.567573752625,45.0989168349476,93.8646198797895,135.964439883273,46.1800409326884,99.9413858110895,132.302705569412,48.9628614310982,77.5214350031376,142.691074237812,44.8079189885018,75.85139979851709,112.927666896766,44.455402884117,86.59484254278711,124.566104779895,46.9211414910028,97.0952639362898,130.284674583917,44.3337518701415,81.0570867693512,116.524849033502,46.6979825181333,96.9990006389073,137.022958768471,44.981606763107,78.0266873500976,115.982771051194,45.8677411237858,91.9178388231271,129.437529141084,44.0891231824574,86.1869900629495,121.446951449152,45.7957008337651,95.5702141831125,124.247710103555,48.5751934157616,95.4889140207671,135.616150016586,46.6746264396707,64.2128343397397,108.069276525399,47.3003340439919,100.56357947157,135.773804191923,49.5994330673168,92.16758788643899,136.481881603382,49.8128407982509,96.9022718666089,133.946108160922,42.7431349353446,77.834009906915,113.878805453771,42.4090485801415,76.5560020697948,114.804382295312,51.938528425621,97.22431227268829,147.085030794411,45.9214064875224,93.7640419990463,130.513143965593,53.6463061746008,97.7312098475156,153.342863350539,50.7493639180898,92.7089782493768,148.07638325303,53.3922033901934,102.875443812183,144.795230019778,47.0288196038204,96.00308391597601,126.139650476691,46.3464759473717,94.8488225133225,123.978121152034,52.3730220317103,93.2721025820228,147.390008854141,46.8106831704731,88.1421550936691,131.531528227435,43.8258686439252,71.0952632969591,131.512402294706,45.7114008698272,93.87371126218579,126.879058739675,42.3977383979923,43.9726817766694,97.6375415903572,43.3971416064251,74.97099272226841,111.123263447952,45.9883474100621,63.0239721248855,106.07580642159,46.4273224540556,87.02300885783551,142.764685880365,46.2922085711633,90.9594125698661,122.408764919138,47.6747052019509,66.6342222847272,109.031789072247,49.9623549140269,93.58991248721971,143.395429255894,46.0108302742818,99.894503895448,125.554482551949,48.5741331571977,97.0693500608369,124.719250561136,45.2988810608998,85.2857168103918,142.985980918212,47.3814409307119,67.8414144822721,110.064329319674,43.7478392921603,48.8335144637489,100.730676320684,45.7437524580626,77.6649301393729,119.610742974348,47.1565083019215,63.3588756475007,109.148029538205,47.7159030514215,98.77576611288301,127.42507937223,45.3187701891108,91.52474904005911,125.713551502377,44.1529855491771,74.6890758281064,109.575202880992,45.5883858642981,77.5097076875669,112.147134589692,42.3205148873705,65.3658448225703,110.242259525753,43.1995567051837,69.5690475526645,113.393137355597,44.2718717662143,70.073588862335,115.37464060082,46.6011873012063,98.0475110580781,132.741749340273,47.6454159027821,80.63334973951309,138.531066073929,46.2540397156384,74.0639720022118,139.045071239857,43.6503459359227,77.17095826314009,122.914170281539,45.5664596759814,97.0785865062979,120.381885139469,44.3008104898582,84.8237111000617,126.987097743131,44.2697231819677,79.552802091636,119.514035029536,43.310181346074,84.48749957024199,116.111197615637,43.5285035307108,75.53433048079209,115.019033299469,44.5997641515528,70.39835724334159,111.004338006252,48.1163131876335,80.2918453136825,125.715639864398,59.599891867077,98.43500351324479,147.349469687681,43.0945908570783,68.6674378452318,110.921798966176,55.1552305742876,84.5485343932328,138.819641110506,45.3630100712722,57.1399035965222,104.362154737358,50.9763353883458,99.34308995973311,134.896576189615,49.9419525872492,87.3824949130159,148.386069036547,46.9284217056841,93.7212656272184,142.911393317669,49.6679492675998,99.2372385392092,138.965075438664,50.3903889520584,93.5159851060115,147.297804000134,46.7277055341817,86.7137293760932,142.037867963011,49.9928496359639,92.9653857728976,142.423119675954,48.3770456805153,101.025700897389,141.318256813428,48.1925508975671,96.9313406243661,143.651596753386,50.1769966354185,93.38339556839961,141.105273631253,48.1916795885334,99.0878403084225,128.954426910693,47.0749825479914,89.9822965132811,141.566850580201,47.5038750470905,100.701875465488,131.959650476402,51.7211494948499,97.4070159805816,137.241568831037,42.9154485639873,74.3790992324523,111.232567902901,42.5834001064111,69.285754639114,109.98128057743,49.5029677477185,93.1934034805316,142.201556069022,49.0902228539051,89.7868843732377,143.499232814578,57.1727468220274,103.533946814166,140.584832421895,48.4321385469954,98.4943474946276,148.357541952576,49.5213667829698,97.0261763257466,144.20458859534,50.5563314214067,94.6606927350046,141.981648764827,44.2559115949393,88.2681948465321,124.262857477613,49.4494564750088,79.3149641224914,143.238550663813,41.5857315080809,61.4816180099803,106.645614508007,46.309226728495,94.9582780562333,132.919778532951,43.9707111353024,72.6886947755691,109.320084373316,40.0407675339618,59.584944386102,106.505790967284,48.780784679026,101.717188393802,147.721325359919,44.4842686504621,72.4401603134021,114.824148972936,50.7735857703624,100.792142001986,136.285166339118,56.8805035833786,102.914426881329,140.025793711305,51.1760571997026,95.2519066432083,142.284245323413,52.6028943485477,99.5216114291463,144.728887802161,49.6496612109254,94.7594166929297,142.009528396629,51.2512915979756,92.5904363019734,137.196324980654,49.2035330400931,97.847148103713,138.100842300361,48.9749345750828,93.6384315594819,149.09933228497,51.3246577444109,101.166730891643,140.55861810847,49.3754274334374,101.022050309366,131.006774558325,42.6364490375024,72.41656609236099,111.942822203173,47.208752431701,92.78919843260191,144.829353228656,45.8833377231293,86.5180229612202,143.4060936021,47.4633178677132,79.35134976603911,134.265778063117,51.276056180679,93.7293521068033,142.920324749372,46.1790916092483,82.96010625199671,142.29440941901,53.6830789933681,96.8585254342737,147.247223409248,54.9097852777514,96.27265128466919,142.716469143518,50.7285861565608,94.33715782039469,138.749003246984,49.0777359481386,98.5051591107343,128.080289963432,50.3453511932199,99.77562980937959,147.176310791927,46.5954848803184,91.6976372292026,145.96459131729,46.7600380319346,89.02784707776701,134.915612159653,46.8771697437487,79.2410342848551,127.606932559354,45.6379628024628,81.6055539674413,121.577898221124,44.5802236213277,91.54760288805009,124.070932177018,49.8803769315318,99.4869218121523,139.063852571342,48.0065909384499,94.7007327084836,135.985654502803,49.1976049061911,101.186250598911,136.207573097633,47.9732766132551,100.109089044969,140.515531306974,48.210717132658,87.2231559015996,135.750978457435,50.9894842574462,90.2271271432721,141.734149257233,51.9586293180192,95.1573389838198,139.109334492114,51.0604806357775,99.87706142536371,133.825053280535,48.3863284945247,92.04190052642321,141.227185386496,49.4139861096715,99.06322445222121,124.378675039611,48.1440288642884,98.0423239813346,137.335390532743,47.8953585359393,97.0924931979737,132.373993403017,45.1666281793693,83.7789442945102,123.680466490906,49.9268150487171,100.223030532018,132.953697614514,50.720678589779,102.371935515187,136.449934985115,52.3876164641498,99.1889375015616,142.917778174122,44.564898379843,92.34341775804479,143.248877632157,50.4123862064911,77.77233408531281,118.151030573494,55.659446983062,85.0745138589288,141.628704526038,51.4789709145304,100.496382439326,142.598729699542,48.4053751961669,100.938828521204,149.951687979125,49.8011458949322,104.502887216993,140.45326242393,46.0116668781892,97.7463176222718,129.526692593026,58.4278816713663,95.652813169781,145.408154886923,55.717321456295,101.703596976924,152.854922731459,52.9632470240543,93.2669187471253,140.519592650097,45.8896747032086,87.9505848253407,139.023650413089,46.827676892753,88.20905273620841,136.873504657372,44.6439479665575,84.179858010654,144.201364959901,48.2289870013284,100.857452009044,132.603111292532,47.7546254998187,99.9841810038622,136.366472037726,44.8188012000698,89.4516338120854,146.0327756156,45.9745866776325,88.4649300432508,146.70247282335,45.2104287082691,83.123621822347,148.948662442721,47.0939602112927,86.9437324798143,142.132019449391,55.3255398504212,95.9880997775667,143.350531975548,51.1318784475455,94.47749847277331,147.755025773075,50.6387695540446,98.0337952901711,145.707051932418,51.6669097167305,97.2692888786048,149.168832103599,51.3926939703742,100.921005096719,136.47459359315,51.5329357234226,93.1819374452907,143.708531436838,46.2523363821377,94.5224381477184,136.589286255495,45.9901119920375,94.04078706711419,126.691493814406,52.4732521686097,98.0367918118631,131.919758437166,48.1501901806476,90.8719223438639,134.637814941876,48.2976136164701,94.08088880963849,136.013255645997,47.8152701227239,96.6054056517371,145.970773359132,49.9990483986795,101.278572193584,133.381080629444,46.9173018890341,97.0160252159821,125.948580852654,48.8205484134971,99.627821283345,122.252389244934,48.4514482777804,97.03724443300671,124.645782762787,48.6840189634731,98.96704550279171,144.696182745383,49.0349408937529,94.7990006218175,145.982487133991,45.0088977597947,75.11380969420399,114.262356162426,44.157925642383,77.94215418310149,114.884835376074,45.4705080701436,93.8476592933395,129.960140199533,47.1459322654137,84.70303456562699,136.038004604946,48.9077401639202,97.1456310854697,142.634265692436,47.8320919467752,103.369917664117,154.266999303666,46.5299929277859,84.85034149971371,137.144518172591,45.9349781924615,90.88266778430381,141.348306270889,45.8358348467588,88.95549107732739,142.93114029859,48.561593297058,93.0958162758011,143.723883569767,48.0108268665221,95.0872785970986,147.398772351557,50.303659324016,93.719606435462,157.351618692431,47.7222549825003,97.1443147848756,150.772078851262,47.5153994186744,91.40734655073049,142.755978589362,48.0016084345871,91.70382555551799,145.765003700975,48.4661055981762,94.4168792248918,143.449663888924,47.6919128946007,94.60214772926111,147.269038033642,48.5101192589241,90.50717579318299,147.372733836667,48.5359955284896,93.18796769318629,141.390442576712,47.8607003785279,87.551427711965,139.383913668893,47.0400365957859,90.5612102521623,144.798436019084,48.1775404442506,96.8740304002318,149.855820799031,46.2694706727193,91.0708988389456,143.268202515503,45.2291638682835,91.2661313383276,142.735614128481,49.6938195696598,93.746581880797,142.880140857551,47.5077166281237,100.155158587847,150.309462038094,45.2615506680224,90.76641610445409,145.310831994944,47.7351107415831,99.0287460700962,149.368375945714,49.6085390068862,100.702104506113,145.786049950679,46.4101459202159,88.99574468225551,145.943431684675,46.7235796787775,99.2195474874253,151.949091098834,47.1357713948257,94.028825746047,142.077804912266,48.821542537658,102.157962214422,149.822584524185,46.8529162883252,92.2881727098862,133.004603471541,49.2742652338616,95.8611720239408,147.167221255525,48.8823403221034,91.11520965613281,147.568316359138,44.8381520939353,92.9509972061259,133.299003090266,47.4530756951363,91.7665936676146,142.482700800367,45.9072380353383,92.3235607305633,146.270459678098,49.2930769726146,97.2567985484644,153.074899030868,48.2281270717812,91.4288268046031,150.904856260929,45.3862660843678,90.4068867695819,146.021736488643,45.9796738216265,85.4406329601407,138.354163473551,50.5538620654417,89.65357587128671,141.025258226577,49.2893171576904,89.40011220173579,146.656726609928,47.8397858326059,94.09662211010389,149.109914886346,48.2175003778981,94.1847206008172,147.279838576109,45.259611526218,85.2434511257248,134.573954163816,53.2561263121122,91.6295116870278,152.236847192589,51.3059327583,99.2358619296792,137.879936429711,45.8222387064896,74.21099379986779,135.271690040013,47.4267954791108,94.16207523094251,137.609735724064,49.9346483510376,99.1544805227213,141.9249866805,55.9122717817203,101.02393438794,145.162250652906,47.6563005310672,91.61645217370121,140.571733529649,44.189493835151,69.3717771833343,113.641411958416,44.4739503176869,63.5652349298659,108.972266695796,46.2526983597583,90.41249830881679,147.236320563514,43.9057600343582,75.3859310201281,116.254680975062,44.2535373856773,72.29567034670779,115.90011494319,45.749625778985,83.6657014183657,118.88339821345,44.2572542166155,76.15973409676801,112.065546953528,44.7000797122538,83.2465228570111,117.179924815957,44.7165228702806,79.0045282169061,113.787594985332,45.0174032908768,75.9962257662992,112.12133375747,49.0165800145914,90.3450919534923,138.402696204772,46.0978120772939,95.9891929360638,138.378080010233,44.5398757815215,83.34105382242819,120.821148677608,45.2239622784267,83.34813651658339,141.255513953955,46.2845344143452,71.683369331253,142.608172333001,51.2913106866149,89.9824167995024,143.64942976361,47.1882928677246,94.91396642662831,140.512764103197,46.2981386950888,81.5673734980208,141.44675539808,56.4423751128188,94.893682334364,142.472724672372,56.8459790345504,95.7795603582002,140.69249225992,50.5962654355411,100.90249490857,139.348105793334,51.8707760871124,93.307959229582,143.738372115703,44.0429274335351,94.1706916526266,122.461015530268,45.6295541335075,82.01162882832151,114.382835341481,44.940613276452,84.84467237775389,116.013738004183,50.1093739676667,76.6139615485388,138.903970149404,54.4769661191947,95.9457558992968,141.331859560029,49.5010702638553,82.40109982413981,127.517945136307,45.4820902077596,97.66051020075361,127.018834641973,46.2898205283352,73.5331751083645,106.740753340326,48.1005440001942,98.0061065034084,129.475591998987]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Entry<\/th>\n      <th>Expt<\/th>\n      <th>MacroEnv<\/th>\n      <th>DTF<\/th>\n      <th>Predicted_DTF<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Entry","targets":1},{"name":"Expt","targets":2},{"name":"MacroEnv","targets":3},{"name":"DTF","targets":4},{"name":"Predicted_DTF","targets":5}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<hr />
</div>
</div>
<div id="correlation-between-two-traits" class="section level1">
<h1>Correlation Between Two Traits</h1>
<p>The most obvious correlation is that of two traits. For example,
since <code>DTF</code>, <code>DTS</code>, and <code>DTM</code> are all
phenology traits, we can assume they will be highly correlated. Lets
plot this out and see how it looks.</p>
<p><img src="correlation_coefficients_01.png" /></p>
<p><strong>Interpretations</strong>:</p>
<ul>
<li>88.3% of variation in <code>DTS</code> is explained by
<code>DTF</code>.</li>
<li>92.7% of variation in <code>DTM</code> is explained by
<code>DTS</code>.</li>
<li>88.7% of variation in <code>DTM</code> is explained by
<code>DTF</code>.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>myCaption <span class="ot">&lt;-</span> <span class="st">&quot;www.dblogr.com/ or derekmichaelwright.github.io/dblogr/ | Data: AGILE&quot;</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>myColors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>,<span class="st">&quot;darkorange&quot;</span>,<span class="st">&quot;darkblue&quot;</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># Remove any rows with missing data</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> d1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(DTF), <span class="sc">!</span><span class="fu">is.na</span>(DTS), <span class="sc">!</span><span class="fu">is.na</span>(DTM))</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co"># DTF - DTS</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d1, <span class="fu">aes</span>(<span class="at">x =</span> DTF, <span class="at">y =</span> DTS)) <span class="sc">+</span> </span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> MacroEnv), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">values =</span> myColors) <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">aes</span>(<span class="at">label =</span> ..rr.label..), <span class="at">rr.digits =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>               <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">parse =</span> T, <span class="at">geom =</span> <span class="st">&quot;label_npc&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>  <span class="fu">theme_agData</span>() <span class="sc">+</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;A) DTF x DTS&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Days to Flower&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Days to Swollen Pods&quot;</span>)</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co"># DTS - DTM</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d1, <span class="fu">aes</span>(<span class="at">x =</span> DTS, <span class="at">y =</span> DTM)) <span class="sc">+</span> </span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> MacroEnv), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">values =</span> myColors) <span class="sc">+</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">aes</span>(<span class="at">label =</span> ..rr.label..), <span class="at">rr.digits =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>               <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">parse =</span> T, <span class="at">geom =</span> <span class="st">&quot;label_npc&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>  <span class="fu">theme_agData</span>() <span class="sc">+</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;B) DTS x DTM&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Days to Swollen Pods&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Days to Maturity&quot;</span>)</span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co"># DTF - DTM</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d1, <span class="fu">aes</span>(<span class="at">x =</span> DTF, <span class="at">y =</span> DTM)) <span class="sc">+</span> </span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> MacroEnv), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">values =</span> myColors) <span class="sc">+</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">aes</span>(<span class="at">label =</span> ..rr.label..), <span class="at">rr.digits =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a>               <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">parse =</span> T, <span class="at">geom =</span> <span class="st">&quot;label_npc&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a>  <span class="fu">theme_agData</span>() <span class="sc">+</span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;C) DTF x DTM&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Days to Flower&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Days to Maturity&quot;</span>,</span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a>       <span class="at">caption =</span> myCaption)</span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a><span class="co"># Append and Save</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">&quot;h&quot;</span>,</span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a>                <span class="at">common.legend =</span> T, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;correlation_coefficients_01.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<hr />
</div>
<div id="calculating-r2" class="section level1">
<h1>Calculating <em>R<sup>2</sup></em></h1>
<div id="pearsons-r2" class="section level2">
<h2><em>Pearson’s R<sup>2</sup></em></h2>
<p><em>R<sup>2</sup></em> can be calculated using the <code>cor</code>
function which has <code>method = "pearson"</code> as the default.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> d1<span class="sc">$</span>DTF, <span class="at">y =</span> d1<span class="sc">$</span>DTS, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 0.8833893</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> d1<span class="sc">$</span>DTS, <span class="at">y =</span> d1<span class="sc">$</span>DTM, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 0.9272951</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> d1<span class="sc">$</span>DTF, <span class="at">y =</span> d1<span class="sc">$</span>DTM, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 0.8868398</code></pre>
<p><em>R<sup>2</sup></em> can also be manually calculated using the
following formula to calculate <em>Pearson’s r</em>:</p>
<p><span class="math inline">\(r=\frac{n\sum xy - (\sum x)(\sum
y)}{\sqrt{(n\sum x^2 - (\sum x)^2)(n\sum y^2 - (\sum
y)^2)}}\)</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(x\)</span> = Independant variable</li>
<li><span class="math inline">\(y\)</span> = Dependant Variable</li>
<li><span class="math inline">\(n\)</span> = Number of observations</li>
</ul>
<p>and</p>
<p><span class="math inline">\(R^2=r^2\)</span></p>
<p>Now lets manually create a function to calculate
<em>R<sup>2</sup></em> using <em>Pearson’s r</em>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>pearsonsR2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  r_numerator <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">sum</span>(x<span class="sc">*</span>y) <span class="sc">-</span> <span class="fu">sum</span>(x) <span class="sc">*</span> <span class="fu">sum</span>(y)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  r_denominator <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">*</span> <span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">sum</span>(x)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> (n <span class="sc">*</span> <span class="fu">sum</span>(y<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">sum</span>(y)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  r <span class="ot">&lt;-</span> r_numerator <span class="sc">/</span> r_denominator</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>}</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="fu">pearsonsR2</span>(<span class="at">x =</span> d1<span class="sc">$</span>DTF, <span class="at">y =</span> d1<span class="sc">$</span>DTS)</span></code></pre></div>
<pre><code>## [1] 0.8833893</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">pearsonsR2</span>(<span class="at">x =</span> d1<span class="sc">$</span>DTS, <span class="at">y =</span> d1<span class="sc">$</span>DTM)</span></code></pre></div>
<pre><code>## [1] 0.9272951</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">pearsonsR2</span>(<span class="at">x =</span> d1<span class="sc">$</span>DTF, <span class="at">y =</span> d1<span class="sc">$</span>DTM)</span></code></pre></div>
<pre><code>## [1] 0.8868398</code></pre>
<p>Switching the <code>x</code> and <code>y</code> variables gives the
same result.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">pearsonsR2</span>(<span class="at">x =</span> d1<span class="sc">$</span>DTM, <span class="at">y =</span> d1<span class="sc">$</span>DTF)</span></code></pre></div>
<pre><code>## [1] 0.8868398</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> d1<span class="sc">$</span>DTM, <span class="at">y =</span> d1<span class="sc">$</span>DTF, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 0.8868398</code></pre>
<p>Note that the <code>stat_poly_eq</code> function included the option
<code>formula = y ~ x</code>, which creates a linear regression of the
<code>x</code> and <code>y</code> variables. Our <em>R<sup>2</sup></em>
is a measure how how well the <code>DTM</code> data matches the
<em>predictions of DTM</em> based on our <code>DTF</code> data and
linear regression model.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># Perform linear regression</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>myModel <span class="ot">&lt;-</span> <span class="fu">lm</span>(DTM <span class="sc">~</span> DTF, <span class="at">data =</span> d1)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="fu">summary</span>(myModel)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = DTM ~ DTF, data = d1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -21.443  -6.744  -1.465   5.132  23.879 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 47.91678    3.82211   12.54 2.78e-16 ***
## DTF          0.95699    0.05096   18.78  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 9.601 on 45 degrees of freedom
## Multiple R-squared:  0.8868, Adjusted R-squared:  0.8843 
## F-statistic: 352.7 on 1 and 45 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">summary</span>(myModel)<span class="sc">$</span>r.squared</span></code></pre></div>
<pre><code>## [1] 0.8868398</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># Get predicted values and residual values from model</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> d1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Predicted_DTM =</span> <span class="fu">predict</span>(myModel), </span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>                    <span class="at">Residuals_DTM =</span> <span class="fu">residuals</span>(myModel) )</span></code></pre></div>
<p>We can also calculate <em>R<sup>2</sup></em> by replacing
<code>DTF</code> with with the <code>Predicted_DTM</code> values from
our linear regression model.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">pearsonsR2</span>(<span class="at">x =</span> d1<span class="sc">$</span>Predicted_DTM, <span class="at">y =</span> d1<span class="sc">$</span>DTM)</span></code></pre></div>
<pre><code>## [1] 0.8868398</code></pre>
<p>Again, switching the x and y variables gives the same result.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">pearsonsR2</span>(<span class="at">x =</span> d1<span class="sc">$</span>DTM, <span class="at">y =</span> d1<span class="sc">$</span>Predicted_DTM)</span></code></pre></div>
<pre><code>## [1] 0.8868398</code></pre>
</div>
<div id="sum-of-squares-r2" class="section level2">
<h2><em>Sum of Squares R<sup>2</sup></em></h2>
<p>If you have <em>Observed</em> and <em>Predicted</em> values,
<em>R<sup>2</sup></em> can also be calculated using the <em>Sum of
Squares</em> formula:</p>
<p><span
class="math inline">\(R^2=1-\frac{SS_{residuals}}{SS_{total}}=1-\frac{\sum
(o-p)^2}{\sum (o-\bar{o})^2}\)</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(o\)</span> = Observed value</li>
<li><span class="math inline">\(p\)</span> = Predicted value</li>
<li><span class="math inline">\(\bar{o}=\frac{\sum o}{n}\)</span> = Mean
of observed values</li>
</ul>
<p>Now lets manually create a function to calculate
<em>R<sup>2</sup></em> using the <em>Sum of Squares</em>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>SumOfSquaresR2 <span class="ot">&lt;-</span> <span class="cf">function</span>(o, p) { <span class="dv">1</span> <span class="sc">-</span> ( <span class="fu">sum</span>((o <span class="sc">-</span> p)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>((o <span class="sc">-</span> <span class="fu">mean</span>(o))<span class="sc">^</span><span class="dv">2</span>) ) }</span></code></pre></div>
<p>Create a plot to visualize the <em>Total Sum of Squares</em> and
<em>Residual Sum of Squares</em></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>xx <span class="ot">&lt;-</span> d1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Expt <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Ro17&quot;</span>,<span class="st">&quot;Ne17&quot;</span>,<span class="st">&quot;Sp17&quot;</span>,<span class="st">&quot;It17&quot;</span>), Rep <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a><span class="co"># Total Sum of Squares Plot</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> DTF, <span class="at">y =</span> DTM)) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">x =</span> <span class="dv">40</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">size =</span> <span class="dv">5</span>, </span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>            <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">bar</span>(<span class="st">&quot;y&quot;</span>))), <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">fill =</span> <span class="st">&quot;coral&quot;</span>, <span class="at">color =</span> <span class="fu">alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.5</span>),</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">xmin =</span> DTF, <span class="at">xmax =</span> DTF <span class="sc">+</span> (<span class="fu">mean</span>(d1<span class="sc">$</span>DTM, <span class="at">na.rm =</span> T) <span class="sc">-</span> DTM), </span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>                <span class="at">ymin =</span> DTM, <span class="at">ymax =</span> <span class="fu">mean</span>(d1<span class="sc">$</span>DTM, <span class="at">na.rm =</span> T))) <span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(d1<span class="sc">$</span>DTM, <span class="at">na.rm =</span> T), <span class="at">color =</span> <span class="st">&quot;coral&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, ) <span class="sc">+</span> </span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> d1,<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>  <span class="fu">theme_agData</span>() <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;A) Total Sum of Squares&quot;</span>,</span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Days to Maturity&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Days to Flower&quot;</span>)</span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a><span class="co"># Residual Sum of Squares Plot</span></span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> DTF, <span class="at">y =</span> DTM)) <span class="sc">+</span> </span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">x =</span> <span class="dv">70</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">size =</span> <span class="dv">5</span>, </span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a>            <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">&quot;f&quot;</span>)), <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">fill =</span> <span class="st">&quot;darkorchid&quot;</span>, <span class="at">color =</span> <span class="fu">alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.5</span>),</span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">xmin =</span> DTF, <span class="at">xmax =</span> DTF <span class="sc">-</span> Residuals_DTM, </span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a>                <span class="at">ymin =</span> DTM, <span class="at">ymax =</span> Predicted_DTM)) <span class="sc">+</span></span>
<span id="cb31-23"><a href="#cb31-23" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> d1, <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&quot;darkorchid&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-24"><a href="#cb31-24" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb31-25"><a href="#cb31-25" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> d1, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb31-26"><a href="#cb31-26" tabindex="-1"></a>  <span class="fu">theme_agData</span>() <span class="sc">+</span></span>
<span id="cb31-27"><a href="#cb31-27" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;B) Residual Sum of Squares&quot;</span>,</span>
<span id="cb31-28"><a href="#cb31-28" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Days to Maturity&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Days to Flower&quot;</span>,</span>
<span id="cb31-29"><a href="#cb31-29" tabindex="-1"></a>       <span class="at">caption =</span> myCaption)</span>
<span id="cb31-30"><a href="#cb31-30" tabindex="-1"></a><span class="co"># Appened</span></span>
<span id="cb31-31"><a href="#cb31-31" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">&quot;h&quot;</span>)</span>
<span id="cb31-32"><a href="#cb31-32" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;correlation_coefficients_02.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="correlation_coefficients_02.png" /></p>
<p>In this case:</p>
<ul>
<li><span class="math inline">\(o\)</span> = Observed value =
<code>DTM</code></li>
<li><span class="math inline">\(p\)</span> = Predicted value =
<code>Predicted_DTM</code></li>
<li><span class="math inline">\(\bar{o}\)</span> = Mean of observed
values = <code>mean(DTM, na.rm = T)</code></li>
</ul>
<p>Now lets calculate <em>R<sup>2</sup></em> using the <em>Sum of
Squares</em> formula.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">SumOfSquaresR2</span>(<span class="at">o =</span> d1<span class="sc">$</span>DTM, <span class="at">p =</span> d1<span class="sc">$</span>Predicted_DTM)</span></code></pre></div>
<pre><code>## [1] 0.8868398</code></pre>
<p>Now, Swaping the <code>x</code> and <code>y</code> variables results
in different values. <strong>Why?</strong></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">SumOfSquaresR2</span>(<span class="at">p =</span> d1<span class="sc">$</span>DTM, <span class="at">o =</span> d1<span class="sc">$</span>Predicted_DTM)</span></code></pre></div>
<pre><code>## [1] 0.8724006</code></pre>
<p>It is important to set <code>DTM</code> as the <em>observed</em>
variable and <code>Predicted_DTM</code> as the <em>predicted</em>
variable. This is becuase with the sum of squares model, our trendline
has a <code>slope = 1</code> and <code>intercept = 0</code>
(<code>geom_abline</code>), which is matched by
<code>lm(DTM~Predicted_DTM)</code> but not
<code>lm(Predicted_DTM~DTM)</code>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="co"># Intercept = 0, Slope = 1</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">lm</span>(DTM <span class="sc">~</span> Predicted_DTM, <span class="at">data =</span> d1)<span class="sc">$</span>coefficients, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   (Intercept) Predicted_DTM 
##             0             1</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="co"># Intercept != 0, Slope != 1</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">lm</span>(Predicted_DTM <span class="sc">~</span> DTM, <span class="at">data =</span> d1)<span class="sc">$</span>coefficients, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## (Intercept)         DTM 
##      12.980       0.887</code></pre>
<p>This can be visualized by showing how the trendline
(<code>geom_smooth(method = "lm")</code>) devaites from the 1:1 line
(<code>geom_abline()</code>).</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>mymin <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">c</span>(d1<span class="sc">$</span>DTM, d1<span class="sc">$</span>Predicted_DTM))</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>mymax <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">c</span>(d1<span class="sc">$</span>DTM, d1<span class="sc">$</span>Predicted_DTM))</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d1, <span class="fu">aes</span>(<span class="at">y =</span> DTM, <span class="at">x =</span> Predicted_DTM)) <span class="sc">+</span> </span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> MacroEnv), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>,<span class="st">&quot;darkorange&quot;</span>,<span class="st">&quot;darkblue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span> </span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span></span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a>  <span class="fu">theme_agData</span>() <span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;A)&quot;</span>)</span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d1, <span class="fu">aes</span>(<span class="at">x =</span> DTM, <span class="at">y =</span> Predicted_DTM)) <span class="sc">+</span> </span>
<span id="cb40-13"><a href="#cb40-13" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> F, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb40-14"><a href="#cb40-14" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb40-15"><a href="#cb40-15" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> MacroEnv), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb40-16"><a href="#cb40-16" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>,<span class="st">&quot;darkorange&quot;</span>,<span class="st">&quot;darkblue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb40-17"><a href="#cb40-17" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span> </span>
<span id="cb40-18"><a href="#cb40-18" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span></span>
<span id="cb40-19"><a href="#cb40-19" tabindex="-1"></a>  <span class="fu">theme_agData</span>() <span class="sc">+</span></span>
<span id="cb40-20"><a href="#cb40-20" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;B)&quot;</span>, <span class="at">caption =</span> myCaption)</span>
<span id="cb40-21"><a href="#cb40-21" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">legend =</span> <span class="st">&quot;none&quot;</span>, <span class="at">align =</span> <span class="st">&quot;h&quot;</span>)</span>
<span id="cb40-22"><a href="#cb40-22" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;correlation_coefficients_03.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>Correlations between A) Predicted DTM and DTM and B) DTM and
Predicted DTM.</p>
<p><img src="correlation_coefficients_03.png" /></p>
<p><strong>Why is this important?</strong> Improper usage can lead to
inncorrect interpretations. The example above involved inncorrectly
calculating <em>R<sup>2</sup></em> by swapping our observed and
predicted variables within the <em>Sum of Squares</em> (<em>SS</em>)
formula. Another example would be using the <em>Sum of Squares</em>
formula without predictions vs. observations. <em>E.g.,</em> if we
calculate <em>R<sup>2</sup></em> using our <code>SumOfSquaresR2</code>
function with <code>DTF</code> vs <code>DTM</code>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">SumOfSquaresR2</span>(<span class="at">o =</span> d1<span class="sc">$</span>DTF, <span class="at">p =</span> d1<span class="sc">$</span>DTM)</span></code></pre></div>
<pre><code>## [1] -1.789874</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>mymin <span class="ot">&lt;-</span> <span class="fu">min</span>(d1<span class="sc">$</span>DTF)</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>mymax <span class="ot">&lt;-</span> <span class="fu">max</span>(d1<span class="sc">$</span>DTM)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d1, <span class="fu">aes</span>(<span class="at">x =</span> DTF, <span class="at">y =</span> DTM)) <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> DTF, <span class="at">yend =</span> Predicted_DTM)) <span class="sc">+</span></span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> MacroEnv), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>,<span class="st">&quot;darkorange&quot;</span>,<span class="st">&quot;darkblue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span></span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>  <span class="fu">theme_agData</span>() <span class="sc">+</span></span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="st">&quot;A) &quot;</span>, <span class="fu">italic</span>(<span class="st">&quot;Pearson&#39;s R&quot;</span>)<span class="sc">^</span><span class="dv">2</span>, <span class="st">&quot; = &quot;</span>, r2), </span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a>         <span class="fu">list</span>(<span class="at">r2 =</span> <span class="fu">round</span>(<span class="fu">pearsonsR2</span>(<span class="at">x =</span> d1<span class="sc">$</span>DTF, <span class="at">y =</span> d1<span class="sc">$</span>DTM), <span class="dv">3</span>))))</span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d1, <span class="fu">aes</span>(<span class="at">x =</span> DTF, <span class="at">y =</span> DTM)) <span class="sc">+</span></span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> DTF, <span class="at">yend =</span> DTF)) <span class="sc">+</span></span>
<span id="cb43-17"><a href="#cb43-17" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> MacroEnv), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb43-18"><a href="#cb43-18" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>,<span class="st">&quot;darkorange&quot;</span>,<span class="st">&quot;darkblue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb43-19"><a href="#cb43-19" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span></span>
<span id="cb43-20"><a href="#cb43-20" tabindex="-1"></a>  <span class="fu">theme_agData</span>() <span class="sc">+</span></span>
<span id="cb43-21"><a href="#cb43-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="st">&quot;B) &quot;</span>, <span class="fu">italic</span>(<span class="st">&quot;Sum of Squares R&quot;</span>)<span class="sc">^</span><span class="dv">2</span>, <span class="st">&quot; = &quot;</span>, r2), </span>
<span id="cb43-22"><a href="#cb43-22" tabindex="-1"></a>         <span class="fu">list</span>(<span class="at">r2 =</span> <span class="fu">round</span>(<span class="fu">SumOfSquaresR2</span>(d1<span class="sc">$</span>DTF, d1<span class="sc">$</span>DTM), <span class="dv">3</span>))),</span>
<span id="cb43-23"><a href="#cb43-23" tabindex="-1"></a>       <span class="at">caption =</span> myCaption)</span>
<span id="cb43-24"><a href="#cb43-24" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, <span class="at">nrow=</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">legend =</span> <span class="st">&quot;none&quot;</span>, <span class="at">align =</span> <span class="st">&quot;h&quot;</span>)</span>
<span id="cb43-25"><a href="#cb43-25" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;correlation_coefficients_04.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>Calculations of <em>R^2</em> using A) <em>Pearson’s</em> formula and
B) <em>Sum of Squares</em> formula.</p>
<p><img src="correlation_coefficients_04.png" /></p>
<p>However, the more common mistake happens when the <em>Pearson’s</em>
formula is used for evaluating the accuracy of a model used to predict
values.</p>
<hr />
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>mymin <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">c</span>(d2<span class="sc">$</span>DTF, d2<span class="sc">$</span>Predicted_DTF))</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>mymax <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">c</span>(d2<span class="sc">$</span>DTF, d2<span class="sc">$</span>Predicted_DTF))</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d2, <span class="fu">aes</span>(<span class="at">x =</span> Predicted_DTF, <span class="at">y =</span> DTF)) <span class="sc">+</span> </span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> MacroEnv), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Expt<span class="sc">~</span>., <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">parse =</span> T, <span class="at">rr.digits =</span> <span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>,<span class="st">&quot;darkorange&quot;</span>,<span class="st">&quot;darkblue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a>  <span class="fu">theme_agData</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Incorrect usage of &quot;</span>, </span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a>                                <span class="fu">italic</span>(<span class="st">&quot;Pearson&#39;s R&quot;</span>)<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a>       <span class="at">caption =</span> myCaption)</span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;correlation_coefficients_05.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>Inncorrect usage of <em>Pearson’s R^2</em> to calculate accuracy of a
model predicting DTF accross 3 site-years.</p>
<p><img src="correlation_coefficients_05.png" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>my_ggplot_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(expt, color) {</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>  <span class="co"># Prep data</span></span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Expt <span class="sc">==</span> expt) </span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Trendline =</span> <span class="fu">predict</span>(<span class="fu">lm</span>(DTF <span class="sc">~</span> Predicted_DTF, <span class="at">data =</span> xx)))</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>  mymin <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">c</span>(xx<span class="sc">$</span>DTF, xx<span class="sc">$</span>Predicted_DTF))</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>  mymax <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">c</span>(xx<span class="sc">$</span>DTF, xx<span class="sc">$</span>Predicted_DTF))</span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a>  <span class="co"># Plot</span></span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a>  mp1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Predicted_DTF, <span class="at">y =</span> DTF)) <span class="sc">+</span> </span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> Predicted_DTF, <span class="at">yend =</span> Trendline), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> color, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span></span>
<span id="cb45-15"><a href="#cb45-15" tabindex="-1"></a>    <span class="fu">theme_agData</span>() <span class="sc">+</span></span>
<span id="cb45-16"><a href="#cb45-16" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> expt,</span>
<span id="cb45-17"><a href="#cb45-17" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;Pearson&#39;s R&quot;</span>)<span class="sc">^</span><span class="dv">2</span>, <span class="st">&quot; = &quot;</span>, r2), </span>
<span id="cb45-18"><a href="#cb45-18" tabindex="-1"></a>           <span class="fu">list</span>(<span class="at">r2 =</span> <span class="fu">round</span>(<span class="fu">pearsonsR2</span>(<span class="at">x =</span> xx<span class="sc">$</span>DTF, <span class="at">y =</span> xx<span class="sc">$</span>Predicted_DTF), <span class="dv">3</span>))))</span>
<span id="cb45-19"><a href="#cb45-19" tabindex="-1"></a>  mp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Predicted_DTF, <span class="at">y =</span> DTF)) <span class="sc">+</span> </span>
<span id="cb45-20"><a href="#cb45-20" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> Predicted_DTF, <span class="at">yend =</span> Predicted_DTF), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb45-21"><a href="#cb45-21" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> color, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb45-22"><a href="#cb45-22" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb45-23"><a href="#cb45-23" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span></span>
<span id="cb45-24"><a href="#cb45-24" tabindex="-1"></a>    <span class="fu">theme_agData</span>() <span class="sc">+</span></span>
<span id="cb45-25"><a href="#cb45-25" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;Sum of Squares R&quot;</span>)<span class="sc">^</span><span class="dv">2</span>, <span class="st">&quot; = &quot;</span>, r2), </span>
<span id="cb45-26"><a href="#cb45-26" tabindex="-1"></a>           <span class="fu">list</span>(<span class="at">r2 =</span> <span class="fu">round</span>(<span class="fu">SumOfSquaresR2</span>(xx<span class="sc">$</span>DTF, xx<span class="sc">$</span>Predicted_DTF), <span class="dv">3</span>))),</span>
<span id="cb45-27"><a href="#cb45-27" tabindex="-1"></a>         <span class="at">caption =</span> myCaption)</span>
<span id="cb45-28"><a href="#cb45-28" tabindex="-1"></a>  <span class="fu">ggarrange</span>(mp1, mp2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">&quot;h&quot;</span>)</span>
<span id="cb45-29"><a href="#cb45-29" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">my_ggplot_1</span>(<span class="st">&quot;Saskatchewan&quot;</span>, <span class="at">color =</span> <span class="st">&quot;darkgreen&quot;</span>)</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;correlation_coefficients_06.png&quot;</span>, mp1, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="fl">3.5</span>)</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">my_ggplot_1</span>(<span class="st">&quot;Nepal&quot;</span>, <span class="at">color =</span> <span class="st">&quot;darkorange&quot;</span>)</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;correlation_coefficients_07.png&quot;</span>, mp2, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="fl">3.5</span>)</span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">my_ggplot_1</span>(<span class="st">&quot;Italy&quot;</span>, <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>)</span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;correlation_coefficients_08.png&quot;</span>, mp3, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="fl">3.5</span>)</span></code></pre></div>
<p>Inncorrect vs correct usage of <em>R^2</em> formulas to calculate
accuracy of a model predicting DTF accross 3 site-years.</p>
<p><img src="correlation_coefficients_06.png" /></p>
<p>Inncorrect vs correct usage of <em>R^2</em> formulas to calculate
accuracy of a model predicting DTF accross 3 site-years.</p>
<p><img src="correlation_coefficients_07.png" /></p>
<p>Inncorrect vs correct usage of <em>R^2</em> formulas to calculate
accuracy of a model predicting DTF accross 3 site-years.</p>
<p><img src="correlation_coefficients_08.png" /></p>
<hr />
</div>
</div>
<div id="negative-r2-values" class="section level1">
<h1>Negative <em>R<sup>2</sup></em> values</h1>
<p>Using <em>Pearson’s</em> formula <em>R<sup>2</sup></em> values will
always fall between 0 and 1. However, when using the <em>Sum of
Squares</em> formula (which has an intercept of 0), negative values can
be aquired.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co"># Calculate R^2 for Ne17</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>xx <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Expt <span class="sc">==</span> <span class="st">&quot;Nepal&quot;</span>)</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a><span class="fu">SumOfSquaresR2</span>(<span class="at">o =</span> xx<span class="sc">$</span>DTF, <span class="at">p =</span> xx<span class="sc">$</span>Predicted_DTF)</span></code></pre></div>
<pre><code>## [1] -2.581473</code></pre>
<p><em>R<sup>2</sup></em> for <code>Ne17</code> is &lt; 0, What does
this mean? and how do we interpret it?</p>
<p><em>R<sup>2</sup></em> = 1 = regression is perfect, no errors</p>
<p>since,</p>
<p><span
class="math inline">\(R^2=1-\frac{SS_{residuals}}{SS_{total}}=1-\frac{0}{\sum
(x-\bar{x})}=1\)</span></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="co"># Calculate R^2 of perfect regression</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="fu">SumOfSquaresR2</span>(<span class="at">o =</span> xx<span class="sc">$</span>DTF, <span class="at">p =</span> xx<span class="sc">$</span>DTF)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p><em>R<sup>2</sup></em> = 0 = regression is no better than using the
mean</p>
<p>since,</p>
<p><span class="math inline">\(y=\bar{x}\)</span></p>
<p>and,</p>
<p><span
class="math inline">\(R^2=1-\frac{SS_{residuals}}{SS_{total}}=1-\frac{\sum
(x-\bar{x})}{\sum (x-\bar{x})}=1-1=0\)</span></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>xx <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Mean_DTF =</span> <span class="fu">mean</span>(DTF))</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a><span class="co"># Calculate R^2 with mean</span></span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a><span class="fu">SumOfSquaresR2</span>(<span class="at">o =</span> xx<span class="sc">$</span>DTF, <span class="at">p =</span> xx<span class="sc">$</span>Mean_DTF)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p><em>R<sup>2</sup></em> &lt; 0 = regression is worse than using the
mean.</p>
<p><span
class="math inline">\(R^2=1-\frac{SS_{residuals}}{SS_{total}}=1-(&gt;1)=(&lt;0)\)</span></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="co"># Calculate the Sum of Squares for the residuals</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a><span class="fu">sum</span>((xx<span class="sc">$</span>DTF <span class="sc">-</span> xx<span class="sc">$</span>Predicted_DTF)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 226005</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="co"># Calculate the total Sum of Squares</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a><span class="fu">sum</span>((xx<span class="sc">$</span>DTF <span class="sc">-</span> <span class="fu">mean</span>(xx<span class="sc">$</span>DTF))<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 63103.93</code></pre>
<p><span class="math inline">\(SS_{residuals} &gt;
SS_{total}\)</span></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Total Sum of Squares =&quot;</span>, </span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>            <span class="fu">round</span>(<span class="fu">sum</span>((xx<span class="sc">$</span>DTF <span class="sc">-</span> <span class="fu">mean</span>(xx<span class="sc">$</span>DTF))<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Residual Sum of Squares =&quot;</span>, </span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a>            <span class="fu">round</span>(<span class="fu">sum</span>((xx<span class="sc">$</span>DTF <span class="sc">-</span> xx<span class="sc">$</span>Predicted_DTF)<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Predicted_DTF, <span class="at">y =</span> DTF)) <span class="sc">+</span> </span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(xx<span class="sc">$</span>DTF), <span class="at">color =</span> <span class="st">&quot;coral&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> Predicted_DTF, <span class="at">yend =</span> Mean_DTF), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb57-9"><a href="#cb57-9" tabindex="-1"></a>  <span class="fu">theme_agData</span>() <span class="sc">+</span></span>
<span id="cb57-10"><a href="#cb57-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Nepal&quot;</span>, <span class="at">subtitle =</span> t1)</span>
<span id="cb57-11"><a href="#cb57-11" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Predicted_DTF, <span class="at">y =</span> DTF)) <span class="sc">+</span> </span>
<span id="cb57-12"><a href="#cb57-12" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">&quot;darkorchid&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb57-13"><a href="#cb57-13" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> Predicted_DTF, <span class="at">yend =</span> Predicted_DTF), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb57-14"><a href="#cb57-14" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb57-15"><a href="#cb57-15" tabindex="-1"></a>  <span class="fu">theme_agData</span>() <span class="sc">+</span></span>
<span id="cb57-16"><a href="#cb57-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>, <span class="at">subtitle =</span> t2, <span class="at">caption =</span> myCaption)</span>
<span id="cb57-17"><a href="#cb57-17" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">&quot;h&quot;</span>)</span>
<span id="cb57-18"><a href="#cb57-18" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;correlation_coefficients_09.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>Visualization of A) Total Sum of Sqaures and B) Residual Sum of
Squares for the predicted DTF values for Nepal.</p>
<p><img src="correlation_coefficients_09.png" /></p>
<hr />
</div>
<div id="effect-of-range" class="section level1">
<h1>Effect of Range</h1>
<p>Another factor to keep in mind, when considering
<em>R<sup>2</sup></em>, is the effect of the range of the data.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> d1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(MacroEnv <span class="sc">==</span> <span class="st">&quot;Macroenvironment 1&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Range =</span> <span class="st">&quot;Low&quot;</span>)</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> x1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">DTF =</span> DTF <span class="sc">+</span> <span class="dv">20</span>, <span class="at">DTM =</span> DTM <span class="sc">+</span> <span class="dv">20</span>, <span class="at">Range =</span> <span class="st">&quot;High&quot;</span>,</span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>                    <span class="at">MacroEnv =</span> <span class="st">&quot;Macroenvironment 2&quot;</span>)</span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(x1, x2) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Range =</span> <span class="st">&quot;Both&quot;</span>)</span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(x1, x2, x3) <span class="sc">%&gt;%</span> </span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Range =</span> <span class="fu">factor</span>(Range, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Low&quot;</span>,<span class="st">&quot;High&quot;</span>,<span class="st">&quot;Both&quot;</span>)))</span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> DTF, <span class="at">y =</span> DTM)) <span class="sc">+</span> </span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> MacroEnv)) <span class="sc">+</span> </span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">parse =</span> T, <span class="at">rr.digits =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Range) <span class="sc">+</span></span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a>  <span class="fu">theme_agData</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> myCaption)</span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;correlation_coefficients_10.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>Visualization of the effect of range on <em>R^2</em>.</p>
<p><img src="correlation_coefficients_10.png" /></p>
<hr />
</div>
<div id="rmse" class="section level1">
<h1>RMSE</h1>
<p>The <em>The Root-Mean-Square Error</em> (<em>RMSE</em>) is a measure
of the differences between observed and predicted, or an average
deviation of the predicted vs observed values.</p>
<p><span class="math inline">\(RMSE=\frac{\sum (o-p^2}{n}\)</span></p>
<ul>
<li><span class="math inline">\(o\)</span> = Observed value</li>
<li><span class="math inline">\(p\)</span> = Predicted value</li>
<li><span class="math inline">\(n\)</span> = Number of observations</li>
</ul>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="co"># Create RMSE function</span></span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>modelRMSE <span class="ot">&lt;-</span> <span class="cf">function</span>(o, p) {</span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="fu">sum</span>((o<span class="sc">-</span>p)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (<span class="fu">length</span>(o)))</span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>}</span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a><span class="co"># Calculate RMSE for Ro17</span></span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a>xx <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Expt <span class="sc">==</span> <span class="st">&quot;Saskatchewan&quot;</span>)</span>
<span id="cb59-7"><a href="#cb59-7" tabindex="-1"></a><span class="fu">modelRMSE</span>(xx<span class="sc">$</span>DTF, xx<span class="sc">$</span>Predicted_DTF)</span></code></pre></div>
<pre><code>## [1] 1.610582</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="co"># Calculate RMSE for Ne17</span></span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>xx <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Expt <span class="sc">==</span> <span class="st">&quot;Nepal&quot;</span>)</span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a><span class="fu">modelRMSE</span>(xx<span class="sc">$</span>DTF, xx<span class="sc">$</span>Predicted_DTF)</span></code></pre></div>
<pre><code>## [1] 26.4111</code></pre>
<p><strong>interpretation</strong>: the standard deviation of the
unexplained variance in <code>Ro17</code> is <code>0.95</code> and in
<code>Ne17</code> is <code>24.4</code>.</p>
<hr />
</div>
<div id="final-plots" class="section level1">
<h1>Final Plots</h1>
<p>Note: for easier interpretation, the <code>x</code> and
<code>y</code> axis have been swapped, since <em>overpredictions</em>
will be above the <code>geom_abline</code> and <em>underpredictions</em>
below.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a>my_ggplot_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(expts, colors) {</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>  <span class="co"># Prep data</span></span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Expt <span class="sc">%in%</span> expts)</span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">SumOfSquaresR2</span>(<span class="at">o =</span> xx<span class="sc">$</span>DTF, <span class="at">p =</span> xx<span class="sc">$</span>Predicted_DTF), <span class="dv">3</span>)</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>  rmse <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">modelRMSE</span>(<span class="at">o =</span> xx<span class="sc">$</span>DTF, <span class="at">p =</span> xx<span class="sc">$</span>Predicted_DTF), <span class="dv">1</span>)</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>  mymin <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">c</span>(xx<span class="sc">$</span>DTF, xx<span class="sc">$</span>Predicted_DTF))</span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a>  mymax <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">c</span>(xx<span class="sc">$</span>DTF, xx<span class="sc">$</span>Predicted_DTF))</span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a>  <span class="co"># Plot</span></span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> DTF, <span class="at">y =</span> Predicted_DTF)) <span class="sc">+</span></span>
<span id="cb63-10"><a href="#cb63-10" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Expt), <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb63-11"><a href="#cb63-11" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb63-12"><a href="#cb63-12" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span></span>
<span id="cb63-13"><a href="#cb63-13" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span></span>
<span id="cb63-14"><a href="#cb63-14" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb63-15"><a href="#cb63-15" tabindex="-1"></a>    <span class="fu">theme_agData</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb63-16"><a href="#cb63-16" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Predicted DTF&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Observed DTF&quot;</span>,</span>
<span id="cb63-17"><a href="#cb63-17" tabindex="-1"></a>         <span class="at">title =</span> <span class="fu">substitute</span>(</span>
<span id="cb63-18"><a href="#cb63-18" tabindex="-1"></a>           <span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;R&quot;</span>)<span class="sc">^</span><span class="dv">2</span>, <span class="st">&quot; = &quot;</span>, r2, <span class="st">&quot; | &quot;</span>, <span class="fu">italic</span>(<span class="st">&quot;RMSE&quot;</span>), <span class="st">&quot; = &quot;</span>, rmse), </span>
<span id="cb63-19"><a href="#cb63-19" tabindex="-1"></a>           <span class="fu">list</span>(<span class="at">r2 =</span> r2, <span class="at">rmse =</span> rmse)))</span>
<span id="cb63-20"><a href="#cb63-20" tabindex="-1"></a>}</span>
<span id="cb63-21"><a href="#cb63-21" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">my_ggplot_2</span>(<span class="st">&quot;Saskatchewan&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>)  <span class="sc">+</span> <span class="fu">facet_grid</span>(. <span class="sc">~</span> Expt)</span>
<span id="cb63-22"><a href="#cb63-22" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">my_ggplot_2</span>(<span class="st">&quot;Nepal&quot;</span>, <span class="st">&quot;darkorange&quot;</span>) <span class="sc">+</span> <span class="fu">facet_grid</span>(. <span class="sc">~</span> Expt)</span>
<span id="cb63-23"><a href="#cb63-23" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">my_ggplot_2</span>(<span class="st">&quot;Italy&quot;</span>, <span class="st">&quot;darkblue&quot;</span>)   <span class="sc">+</span> <span class="fu">facet_grid</span>(. <span class="sc">~</span> Expt) <span class="sc">+</span></span>
<span id="cb63-24"><a href="#cb63-24" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> myCaption)</span>
<span id="cb63-25"><a href="#cb63-25" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb63-26"><a href="#cb63-26" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;correlation_coefficients_11.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>Correct calculations of <em>R^2</em> for predicted DTF along with
RMSE across 3 site-years.</p>
<p><img src="correlation_coefficients_11.png" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">my_ggplot_2</span>(<span class="at">expts =</span> <span class="fu">c</span>(<span class="st">&quot;Saskatchewan&quot;</span>,<span class="st">&quot;Nepal&quot;</span>,<span class="st">&quot;Italy&quot;</span>), </span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>                <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>,<span class="st">&quot;darkorange&quot;</span>,<span class="st">&quot;darkblue&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;correlation_coefficients_12.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>Calculation of <em>R^2</em> for predicted DTF for all 3
site-years.</p>
<p><img src="correlation_coefficients_12.png" /></p>
<hr />
</div>
<div id="model-evaluation" class="section level1">
<h1>Model Evaluation</h1>
<p>Next we will evaluate a <strong>Photothermal Model</strong> which
describes the reciprical of DTF (<code>RDTF</code>) as a linear function
of temperature and photoperiod:</p>
<p><span
class="math inline">\(\frac{1}{f}=a+b\overline{T}+c\overline{P}\)</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(f\)</span> = Days from sowing to flower
(<code>DTF</code>)</li>
<li><span class="math inline">\(\overline{T}\)</span> = Mean temperature
(<code>T_mean</code>)</li>
<li><span class="math inline">\(\overline{P}\)</span> = Mean photoperiod
(<code>P_mean</code>)</li>
<li><span class="math inline">\(a,b,c\)</span> = Genotype specific
constants</li>
</ul>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="co"># Perform linear regression</span></span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>myModel <span class="ot">&lt;-</span> <span class="fu">lm</span>(RDTF <span class="sc">~</span> T_mean <span class="sc">+</span> P_mean, <span class="at">data =</span> d1)</span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a><span class="fu">summary</span>(myModel)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RDTF ~ T_mean + P_mean, data = d1)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -0.0038951 -0.0005957 -0.0001821  0.0004946  0.0086038 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -1.843e-02  1.894e-03  -9.730 1.54e-12 ***
## T_mean       7.888e-04  8.688e-05   9.079 1.20e-11 ***
## P_mean       1.761e-03  1.223e-04  14.395  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.002006 on 44 degrees of freedom
## Multiple R-squared:  0.8893, Adjusted R-squared:  0.8843 
## F-statistic: 176.8 on 2 and 44 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>In this case we now have multiple independant varables and cannot
correlate <code>RDTF</code> with <code>T_mean</code> +
<code>P_mean</code> using <em>Pearson’s</em> formula. Instead we will
correlate <code>RDTF</code> with the <code>Predicted_RDTF</code> values
that come from the model.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="co"># Get predicted values and residual values from model</span></span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> d1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Predicted_RDTF =</span>     <span class="fu">predict</span>(myModel), </span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>                    <span class="at">Predicted_DTF  =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">predict</span>(myModel),</span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a>                    <span class="at">Residuals_RDTF =</span>     <span class="fu">residuals</span>(myModel),</span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a>                    <span class="at">Residuals_DTF  =</span> <span class="fu">abs</span>( (<span class="dv">1</span><span class="sc">/</span>DTF) <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span>Predicted_DTF) ))</span></code></pre></div>
<p>Calculate <em>R<sup>2</sup></em></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="co"># Calculate R^2 using cor function</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a><span class="fu">cor</span>(d1<span class="sc">$</span>RDTF, d1<span class="sc">$</span>Predicted_RDTF)<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 0.8893289</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="co"># Calculate R^2 using Pearson&#39;s formula</span></span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a><span class="fu">pearsonsR2</span>(<span class="at">x =</span> d1<span class="sc">$</span>RDTF, <span class="at">y =</span> d1<span class="sc">$</span>Predicted_RDTF)</span></code></pre></div>
<pre><code>## [1] 0.8893289</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="co"># Calculate R^2 using SS formula</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a><span class="fu">SumOfSquaresR2</span>(<span class="at">o =</span> d1<span class="sc">$</span>RDTF, <span class="at">p =</span> d1<span class="sc">$</span>Predicted_RDTF)</span></code></pre></div>
<pre><code>## [1] 0.8893289</code></pre>
<p>Each formula gives the same <em>R<sup>2</sup></em> result.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a>mymin <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">c</span>(d1<span class="sc">$</span>RDTF, d1<span class="sc">$</span>Predicted_RDTF))</span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>mymax <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">c</span>(d1<span class="sc">$</span>RDTF, d1<span class="sc">$</span>Predicted_RDTF))</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d1, <span class="fu">aes</span>(<span class="at">x =</span> Predicted_RDTF, <span class="at">y =</span> RDTF)) <span class="sc">+</span></span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">yend =</span> Predicted_RDTF, <span class="at">xend =</span> Predicted_RDTF)) <span class="sc">+</span></span>
<span id="cb74-7"><a href="#cb74-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> MacroEnv, <span class="at">size =</span> <span class="fu">abs</span>(Residuals_RDTF)), </span>
<span id="cb74-8"><a href="#cb74-8" tabindex="-1"></a>             <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb74-9"><a href="#cb74-9" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>,<span class="st">&quot;darkorange&quot;</span>,<span class="st">&quot;darkblue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb74-10"><a href="#cb74-10" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span></span>
<span id="cb74-11"><a href="#cb74-11" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span></span>
<span id="cb74-12"><a href="#cb74-12" tabindex="-1"></a>  <span class="fu">theme_agData</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb74-13"><a href="#cb74-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;R&quot;</span>)<span class="sc">^</span><span class="dv">2</span>, <span class="st">&quot; = &quot;</span>, r2), </span>
<span id="cb74-14"><a href="#cb74-14" tabindex="-1"></a>         <span class="fu">list</span>(<span class="at">r2 =</span> <span class="fu">round</span>(<span class="fu">SumOfSquaresR2</span>(d1<span class="sc">$</span>DTF, d1<span class="sc">$</span>Predicted_DTF), <span class="dv">3</span>))),</span>
<span id="cb74-15"><a href="#cb74-15" tabindex="-1"></a>       <span class="at">caption =</span> myCaption)</span>
<span id="cb74-16"><a href="#cb74-16" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;correlation_coefficients_13.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>Visualizing the accuracy of a model predicting RDTF (1/DTF). Red line
represents the best-fit line.</p>
<p><img src="correlation_coefficients_13.png" /></p>
<p>However, we are interested in <code>DTF</code> and not
<code>RDTF</code>. Let see how <em>R<sup>2</sup></em> changes when we
calculate it for <code>DTF</code> instead of <code>RDTF</code>.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="co"># Calculate R^2 using cor function</span></span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> d1<span class="sc">$</span>DTF, <span class="at">y =</span> d1<span class="sc">$</span>Predicted_DTF)<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 0.8823158</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="co"># Calculate R^2 using Pearson&#39;s formula</span></span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a><span class="fu">pearsonsR2</span>(<span class="at">x =</span> d1<span class="sc">$</span>DTF, <span class="at">y =</span> d1<span class="sc">$</span>Predicted_DTF)</span></code></pre></div>
<pre><code>## [1] 0.8823158</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="co"># Calculate R^2 using SS formula</span></span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a><span class="fu">SumOfSquaresR2</span>(<span class="at">o =</span> d1<span class="sc">$</span>DTF, <span class="at">p =</span> d1<span class="sc">$</span>Predicted_DTF)</span></code></pre></div>
<pre><code>## [1] 0.8775759</code></pre>
<p>Notice the how the values of <em>R<sup>2</sup></em> from
<code>cor</code> or <code>pearssonR2</code> and
<code>SumOfSquaresR2</code> do not match. Why is this occuring?</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a>mymin <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">c</span>(d1<span class="sc">$</span>DTF, d1<span class="sc">$</span>Predicted_DTF))</span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a>mymax <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">c</span>(d1<span class="sc">$</span>DTF, d1<span class="sc">$</span>Predicted_DTF))</span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d1, <span class="fu">aes</span>(<span class="at">y =</span> DTF, <span class="at">x =</span> Predicted_DTF)) <span class="sc">+</span></span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb81-6"><a href="#cb81-6" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">yend =</span> Predicted_DTF, <span class="at">xend =</span> Predicted_DTF)) <span class="sc">+</span></span>
<span id="cb81-7"><a href="#cb81-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Expt, <span class="at">size =</span> <span class="fu">abs</span>(Residuals_DTF)), </span>
<span id="cb81-8"><a href="#cb81-8" tabindex="-1"></a>             <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb81-9"><a href="#cb81-9" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span></span>
<span id="cb81-10"><a href="#cb81-10" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(mymin, mymax)) <span class="sc">+</span></span>
<span id="cb81-11"><a href="#cb81-11" tabindex="-1"></a>  <span class="fu">theme_agData</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb81-12"><a href="#cb81-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;R&quot;</span>)<span class="sc">^</span><span class="dv">2</span>, <span class="st">&quot; = &quot;</span>, r2), </span>
<span id="cb81-13"><a href="#cb81-13" tabindex="-1"></a>         <span class="fu">list</span>(<span class="at">r2 =</span> <span class="fu">round</span>(<span class="fu">SumOfSquaresR2</span>(d1<span class="sc">$</span>DTF, d1<span class="sc">$</span>Predicted_DTF), <span class="dv">3</span>))),</span>
<span id="cb81-14"><a href="#cb81-14" tabindex="-1"></a>       <span class="at">caption =</span> myCaption)</span>
<span id="cb81-15"><a href="#cb81-15" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;correlation_coefficients_14.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>Visualizing the accuracy of a model predicting RDTF (1/DTF). Red line
represents the best-fit line.</p>
<p><img src="correlation_coefficients_14.png" /></p>
<p>Now that we’ve transformed the data, the <code>geom_abline</code> and
<code>geom_smooth</code> lines no longer perfectly overlap, which causes
the slight difference in <em>R<sup>2</sup></em>.</p>
<p>However, this still leaves open the questions of why
<code>geom_abline()</code> and <code>geom_smooth</code> no longer
overlap after transforming the data? Lets try and visualize this with
test data.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Residuals =</span> <span class="fu">abs</span>(y<span class="sc">-</span>x))</span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a>SSt <span class="ot">&lt;-</span> <span class="fu">sum</span>((xx<span class="sc">$</span>x <span class="sc">-</span> <span class="fu">mean</span>(xx<span class="sc">$</span>x))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a>SSr <span class="ot">&lt;-</span> <span class="fu">sum</span>((xx<span class="sc">$</span>x <span class="sc">-</span> xx<span class="sc">$</span>y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb82-6"><a href="#cb82-6" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">1</span> <span class="sc">-</span> SSr <span class="sc">/</span> SSt, <span class="dv">4</span>)</span>
<span id="cb82-7"><a href="#cb82-7" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb82-8"><a href="#cb82-8" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb82-9"><a href="#cb82-9" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span> </span>
<span id="cb82-10"><a href="#cb82-10" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> x, <span class="at">yend =</span> x)) <span class="sc">+</span></span>
<span id="cb82-11"><a href="#cb82-11" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> Residuals), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb82-12"><a href="#cb82-12" tabindex="-1"></a>  <span class="fu">theme_agData</span>() <span class="sc">+</span></span>
<span id="cb82-13"><a href="#cb82-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;R&quot;</span>)<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb82-14"><a href="#cb82-14" tabindex="-1"></a>                                <span class="st">&quot; = 1 - (&quot;</span>, SSr, <span class="st">&quot;/&quot;</span>,SSt, <span class="st">&quot;) = &quot;</span>, r2 ), </span>
<span id="cb82-15"><a href="#cb82-15" tabindex="-1"></a>         <span class="fu">list</span>(<span class="at">SSr =</span> SSr, <span class="at">SSt =</span> SSt, <span class="at">r2 =</span> r2)))</span>
<span id="cb82-16"><a href="#cb82-16" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb82-17"><a href="#cb82-17" tabindex="-1"></a>xx <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Residuals =</span> <span class="fu">abs</span>((<span class="dv">1</span><span class="sc">/</span>y)<span class="sc">-</span>(<span class="dv">1</span><span class="sc">/</span>x)))</span>
<span id="cb82-18"><a href="#cb82-18" tabindex="-1"></a>SSt <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="dv">1</span> <span class="sc">/</span> xx<span class="sc">$</span>x <span class="sc">-</span> <span class="fu">mean</span>(<span class="dv">1</span> <span class="sc">/</span> xx<span class="sc">$</span>x))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb82-19"><a href="#cb82-19" tabindex="-1"></a>SSr <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="dv">1</span> <span class="sc">/</span> xx<span class="sc">$</span>x <span class="sc">-</span> <span class="dv">1</span> <span class="sc">/</span> xx<span class="sc">$</span>y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb82-20"><a href="#cb82-20" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">1</span> <span class="sc">-</span> SSr <span class="sc">/</span> SSt, <span class="dv">4</span>)</span>
<span id="cb82-21"><a href="#cb82-21" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb82-22"><a href="#cb82-22" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span> <span class="sc">/</span> x, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">/</span> y)) <span class="sc">+</span> </span>
<span id="cb82-23"><a href="#cb82-23" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb82-24"><a href="#cb82-24" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> <span class="dv">1</span> <span class="sc">/</span> x, <span class="at">yend =</span> <span class="dv">1</span> <span class="sc">/</span> x)) <span class="sc">+</span></span>
<span id="cb82-25"><a href="#cb82-25" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> Residuals), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb82-26"><a href="#cb82-26" tabindex="-1"></a>  <span class="fu">theme_agData</span>() <span class="sc">+</span></span>
<span id="cb82-27"><a href="#cb82-27" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;R&quot;</span>)<span class="sc">^</span><span class="dv">2</span>, </span>
<span id="cb82-28"><a href="#cb82-28" tabindex="-1"></a>                                <span class="st">&quot; = 1 - (&quot;</span>, SSr, <span class="st">&quot;/&quot;</span>,SSt, <span class="st">&quot;) = &quot;</span>, r2 ), </span>
<span id="cb82-29"><a href="#cb82-29" tabindex="-1"></a>         <span class="fu">list</span>(<span class="at">SSr =</span> <span class="fu">round</span>(SSr, <span class="dv">3</span>), <span class="at">SSt =</span> <span class="fu">round</span>(SSt, <span class="dv">3</span>), <span class="at">r2 =</span> r2)),</span>
<span id="cb82-30"><a href="#cb82-30" tabindex="-1"></a>       <span class="at">caption =</span> myCaption)</span>
<span id="cb82-31"><a href="#cb82-31" tabindex="-1"></a><span class="co"># Append Plots</span></span>
<span id="cb82-32"><a href="#cb82-32" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">legend =</span> <span class="st">&quot;none&quot;</span>, <span class="at">align =</span> <span class="st">&quot;h&quot;</span>)</span>
<span id="cb82-33"><a href="#cb82-33" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;correlation_coefficients_15.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>Change in <em>R^2</em> due to data transformation.</p>
<p><img src="correlation_coefficients_15.png" /></p>
<p>Visualizing the Photothermal model</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> d1<span class="sc">$</span>T_mean</span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> d1<span class="sc">$</span>P_mean</span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a>z <span class="ot">&lt;-</span> d1<span class="sc">$</span>RDTF</span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(d1<span class="sc">$</span>MacroEnv))</span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(z <span class="sc">~</span> x <span class="sc">+</span> y)</span>
<span id="cb83-6"><a href="#cb83-6" tabindex="-1"></a><span class="co"># Create PhotoThermal plane</span></span>
<span id="cb83-7"><a href="#cb83-7" tabindex="-1"></a>fitpoints <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit)</span>
<span id="cb83-8"><a href="#cb83-8" tabindex="-1"></a>grid.lines <span class="ot">=</span> <span class="dv">12</span></span>
<span id="cb83-9"><a href="#cb83-9" tabindex="-1"></a>x.pred <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x), <span class="fu">max</span>(x), <span class="at">length.out =</span> grid.lines)</span>
<span id="cb83-10"><a href="#cb83-10" tabindex="-1"></a>y.pred <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(y), <span class="fu">max</span>(y), <span class="at">length.out =</span> grid.lines)</span>
<span id="cb83-11"><a href="#cb83-11" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x =</span> x.pred, <span class="at">y =</span> y.pred)</span>
<span id="cb83-12"><a href="#cb83-12" tabindex="-1"></a>z.pred <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">predict</span>(fit, <span class="at">newdata =</span> xy), </span>
<span id="cb83-13"><a href="#cb83-13" tabindex="-1"></a>                 <span class="at">nrow =</span> grid.lines, <span class="at">ncol =</span> grid.lines)</span>
<span id="cb83-14"><a href="#cb83-14" tabindex="-1"></a><span class="co"># Plot with regression plane</span></span>
<span id="cb83-15"><a href="#cb83-15" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;correlation_coefficients_16.png&quot;</span>, <span class="at">width =</span> <span class="dv">1000</span>, <span class="at">height =</span> <span class="dv">1000</span>, <span class="at">res =</span> <span class="dv">200</span>)</span>
<span id="cb83-16"><a href="#cb83-16" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb83-17"><a href="#cb83-17" tabindex="-1"></a>plot3D<span class="sc">::</span><span class="fu">scatter3D</span>(x, y, z, <span class="at">pch =</span> <span class="dv">18</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">zlim =</span> <span class="fu">c</span>(<span class="fl">0.005</span>,<span class="fl">0.03</span>),</span>
<span id="cb83-18"><a href="#cb83-18" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">alpha</span>(<span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>,<span class="st">&quot;darkorange&quot;</span>,<span class="st">&quot;darkblue&quot;</span>),<span class="fl">0.5</span>), </span>
<span id="cb83-19"><a href="#cb83-19" tabindex="-1"></a>  <span class="at">colvar =</span> cv, <span class="at">colkey =</span> F, <span class="at">col.grid =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;u&quot;</span>,</span>
<span id="cb83-20"><a href="#cb83-20" tabindex="-1"></a>  <span class="at">theta =</span> <span class="dv">40</span>, <span class="at">phi =</span> <span class="dv">25</span>, <span class="at">ticktype =</span> <span class="st">&quot;detailed&quot;</span>, <span class="at">cex.lab =</span> <span class="dv">1</span>, <span class="at">cex.axis =</span> <span class="fl">0.5</span>,</span>
<span id="cb83-21"><a href="#cb83-21" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Temperature&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Photoperiod&quot;</span>, <span class="at">zlab =</span> <span class="st">&quot;1 / DTF&quot;</span>,</span>
<span id="cb83-22"><a href="#cb83-22" tabindex="-1"></a>  <span class="at">surf =</span> <span class="fu">list</span>(<span class="at">x =</span> x.pred, <span class="at">y =</span> y.pred, <span class="at">z =</span> z.pred, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb83-23"><a href="#cb83-23" tabindex="-1"></a>  <span class="at">facets =</span> <span class="cn">NA</span>, <span class="at">fit =</span> fitpoints), <span class="at">main =</span> <span class="st">&quot;PhotoThermal Model&quot;</span>)</span>
<span id="cb83-24"><a href="#cb83-24" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p>Visualization of the photothermal model (1/DTF = <em>a</em> +
<em>b</em>Temperature + <em>c</em>Photoperiod).</p>
<p><img src="correlation_coefficients_16.png" /></p>
<hr />
</div>
</div>

   
      <br>

      <p style="text-align: center;">
        <a href="https://derekmichaelwright.github.io/dblogr" style="color:#1E3D2A"><i class="fa fa-house"></i>  dblogr.com/</a>
        <a href="https://derekmichaelwright.github.io/dblogr#photography" style="color:#1E3D2A"><i class="fa fa-image"></i></a>
        <a href="https://derekmichaelwright.github.io/dblogr#publications" style="color:#1E3D2A"><i class="fa fa-book"></i></a>
        <a href="https://derekmichaelwright.github.io/dblogr#academic-work" style="color:#1E3D2A"><i class="fa fa-newspaper"></i></a>
        <a href="https://derekmichaelwright.github.io/dblogr#packages" style="color:#1E3D2A"><i class="fab fa-r-project"></i></a>
        <a href="https://derekmichaelwright.github.io/dblogr#blog" style="color:#1E3D2A"><i class="fa fa-chart-line"></i></a>
      </div>

      <p style="text-align: center;">
          &copy; Derek Michael Wright 
          <a href="https://github.com/derekmichaelwright/" class="fa fa-github" style="color:#1E3D2A"></a>
          <a href="https://twitter.com/DerekMWright" class="fa fa-twitter" style="color:#1E3D2A"></a>
      </p>

      <br>
   
            
      

  <script>
    $(document).ready(function () {

			
 		
		$('#content img:not(.no-lightbox)').addClass("image-lb");
	$('#content').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
	    delegate: '.image-lb',
	    gallery: {enabled: true },
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
